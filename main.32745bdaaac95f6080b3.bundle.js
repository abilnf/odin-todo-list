/*! For license information please see main.32745bdaaac95f6080b3.bundle.js.LICENSE.txt */
(()=>{var e={676:function(e,t){!function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function r(e,t,r){var i,s=new Promise((function(s,o){n(i=e[t].apply(e,r)).then(s,o)}));return s.request=i,s}function i(e,t,n){var i=r(e,t,n);return i.then((function(e){if(e)return new l(e,i.request)}))}function s(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function o(e,t,n,i){i.forEach((function(i){i in n.prototype&&(e.prototype[i]=function(){return r(this[t],i,arguments)})}))}function a(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function c(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})}))}function u(e){this._index=e}function l(e,t){this._cursor=e,this._request=t}function h(e){this._store=e}function d(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function f(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new d(n)}function p(e){this._db=e}function g(e,t,n){var i=r(indexedDB,"open",[e,t]),s=i.request;return s&&(s.onupgradeneeded=function(e){n&&n(new f(s.result,e.oldVersion,s.transaction))}),i.then((function(e){return new p(e)}))}function m(e){return r(indexedDB,"deleteDatabase",[e])}s(u,"_index",["name","keyPath","multiEntry","unique"]),o(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),c(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),s(l,"_cursor",["direction","key","primaryKey","value"]),o(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(l.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then((function(e){if(e)return new l(e,t._request)}))}))})})),h.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},s(h,"_store",["name","keyPath","indexNames","autoIncrement"]),o(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),c(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(h,"_store",IDBObjectStore,["deleteIndex"]),d.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},s(d,"_tx",["objectStoreNames","mode"]),a(d,"_tx",IDBTransaction,["abort"]),f.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},s(f,"_db",["name","version","objectStoreNames"]),a(f,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new d(this._db.transaction.apply(this._db,arguments))},s(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[h,u].forEach((function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],i=this._store||this._index,s=i[e].apply(i,n.slice(0,-1));s.onsuccess=function(){r(s.result)}})}))})),[u,h].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})})),e.openDb=g,e.deleteDb=m,Object.defineProperty(e,"__esModule",{value:!0})}(t)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";const e=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},t={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw Error();const c=i<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},r=function(e){try{return t.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};class i{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function s(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function o(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(s())}function a(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function c(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function u(){const e=s();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}class l extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,h.prototype.create)}}class h{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(d,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new l(r,o,n)}}const d=/\{\$([^}]+)}/g;function f(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(p(n)&&p(s)){if(!f(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function p(e){return null!==e&&"object"==typeof e}function g(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function m(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function y(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class v{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=w),void 0===r.error&&(r.error=w),void 0===r.complete&&(r.complete=w);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function w(){}function b(e){return e&&e._delegate?e._delegate:e}class T{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const _="[DEFAULT]";class I{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new i;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:_})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===_?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:_:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class E{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new I(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const S=[];var k;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(k||(k={}));const A={debug:k.DEBUG,verbose:k.VERBOSE,info:k.INFO,warn:k.WARN,error:k.ERROR,silent:k.SILENT},C=k.INFO,N={[k.DEBUG]:"log",[k.VERBOSE]:"log",[k.INFO]:"info",[k.WARN]:"warn",[k.ERROR]:"error"},R=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=N[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class D{constructor(e){this.name=e,this._logLevel=C,this._logHandler=R,this._userLogHandler=null,S.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in k))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?A[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,k.DEBUG,...e),this._logHandler(this,k.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,k.VERBOSE,...e),this._logHandler(this,k.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,k.INFO,...e),this._logHandler(this,k.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,k.WARN,...e),this._logHandler(this,k.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,k.ERROR,...e),this._logHandler(this,k.ERROR,...e)}}class O{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const P="@firebase/app",L="0.7.16",M=new D("@firebase/app"),x="[DEFAULT]",U={[P]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},F=new Map,V=new Map;function j(e,t){try{e.container.addComponent(t)}catch(n){M.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function q(e){const t=e.name;if(V.has(t))return M.debug(`There were multiple attempts to register component ${t}.`),!1;V.set(t,e);for(const t of F.values())j(t,e);return!0}function B(e,t){return e.container.getProvider(t)}const K=new h("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class ${constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new T("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw K.create("app-deleted",{appName:this._name})}}const H="9.6.6";function z(e="[DEFAULT]"){const t=F.get(e);if(!t)throw K.create("no-app",{appName:e});return t}function W(e,t,n){var r;let i=null!==(r=U[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void M.warn(e.join(" "))}q(new T(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}var G;G="",q(new T("platform-logger",(e=>new O(e)),"PRIVATE")),W(P,L,G),W(P,L,"esm2017"),W("fire-js","");W("firebase","9.6.6","app");function J(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;function Q(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const X=Q,Y=new h("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Z=new D("@firebase/auth");function ee(e,...t){Z.logLevel<=k.ERROR&&Z.error(`Auth (9.6.6): ${e}`,...t)}function te(e,...t){throw se(e,...t)}function ne(e,...t){return se(e,...t)}function re(e,t,n){const r=Object.assign(Object.assign({},X()),{[t]:n});return new h("auth","Firebase",r).create(t,{appName:e.name})}function ie(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&te(e,"argument-error"),re(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function se(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Y.create(e,...t)}function oe(e,t,...n){if(!e)throw se(t,...n)}function ae(e){const t="INTERNAL ASSERTION FAILED: "+e;throw ee(t),new Error(t)}function ce(e,t){e||ae(t)}const ue=new Map;function le(e){ce(e instanceof Function,"Expected a class definition");let t=ue.get(e);return t?(ce(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ue.set(e,t),t)}function he(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function de(){return"http:"===fe()||"https:"===fe()}function fe(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class pe{constructor(e,t){this.shortDelay=e,this.longDelay=t,ce(t>e,"Short delay should be less than long delay!"),this.isMobile=o()||c()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(de()||a()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function ge(e,t){ce(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class me{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void ae("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void ae("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void ae("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ye={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},ve=new pe(3e4,6e4);function we(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function be(e,t,n,r,i={}){return Te(e,i,(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=g(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),me.fetch()(Ie(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function Te(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},ye),t);try{const t=new Ee(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Se(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Se(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Se(e,"email-already-in-use",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw re(e,a,o);te(e,a)}}catch(t){if(t instanceof l)throw t;te(e,"network-request-failed")}}async function _e(e,t,n,r,i={}){const s=await be(e,t,n,r,i);return"mfaPendingCredential"in s&&te(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Ie(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?ge(e.config,i):`${e.config.apiScheme}://${i}`}class Ee{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(ne(this.auth,"network-request-failed"))),ve.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Se(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=ne(e,t,r);return i.customData._tokenResponse=n,i}function ke(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Ae(e){return 1e3*Number(e)}function Ce(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return ee("JWT malformed, contained fewer than 3 sections"),null;try{const e=r(n);return e?JSON.parse(e):(ee("Failed to decode base64 JWT payload"),null)}catch(e){return ee("Caught error parsing JWT payload as JSON",e),null}}async function Ne(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof l&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Re{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}class De{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ke(this.lastLoginAt),this.creationTime=ke(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Oe(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Ne(e,async function(e,t){return be(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));oe(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=J(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new De(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class Pe{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){oe(e.idToken,"internal-error"),oe(void 0!==e.idToken,"internal-error"),oe(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Ce(e);return oe(t,"internal-error"),oe(void 0!==t.exp,"internal-error"),oe(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return oe(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Te(e,{},(async()=>{const n=g({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Ie(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",me.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Pe;return n&&(oe("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(oe("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(oe("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pe,this.toJSON())}_performRefresh(){return ae("not implemented")}}function Le(e,t){oe("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Me{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=J(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Re(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new De(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Ne(this,this.stsTokenManager.getToken(this.auth,e));return oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=b(e),r=await n.getIdToken(t),i=Ce(r);oe(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:ke(Ae(i.auth_time)),issuedAtTime:ke(Ae(i.iat)),expirationTime:ke(Ae(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=b(e);await Oe(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Me(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Oe(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Ne(this,async function(e,t){return be(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:T,stsTokenManager:_}=t;oe(v&&_,e,"internal-error");const I=Pe.fromJSON(this.name,_);oe("string"==typeof v,e,"internal-error"),Le(l,e.name),Le(h,e.name),oe("boolean"==typeof w,e,"internal-error"),oe("boolean"==typeof b,e,"internal-error"),Le(d,e.name),Le(f,e.name),Le(p,e.name),Le(g,e.name),Le(m,e.name),Le(y,e.name);const E=new Me({uid:v,auth:e,email:h,emailVerified:w,displayName:l,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:m,lastLoginAt:y});return T&&Array.isArray(T)&&(E.providerData=T.map((e=>Object.assign({},e)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(e,t,n=!1){const r=new Pe;r.updateFromServerResponse(t);const i=new Me({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Oe(i),i}}class xe{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}xe.type="NONE";const Ue=xe;function Fe(e,t,n){return`firebase:${e}:${t}:${n}`}class Ve{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Fe(this.userKey,r.apiKey,i),this.fullPersistenceKey=Fe("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Me._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ve(le(Ue),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||le(Ue);const s=Fe(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=Me._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new Ve(i,e,n)):new Ve(i,e,n)}}function je(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if($e(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(qe(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ze(t))return"Blackberry";if(We(t))return"Webos";if(Be(t))return"Safari";if((t.includes("chrome/")||Ke(t))&&!t.includes("edge/"))return"Chrome";if(He(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function qe(e=s()){return/firefox\//i.test(e)}function Be(e=s()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Ke(e=s()){return/crios\//i.test(e)}function $e(e=s()){return/iemobile/i.test(e)}function He(e=s()){return/android/i.test(e)}function ze(e=s()){return/blackberry/i.test(e)}function We(e=s()){return/webos/i.test(e)}function Ge(e=s()){return/iphone|ipad|ipod/i.test(e)}function Je(e=s()){return Ge(e)||He(e)||We(e)||ze(e)||/windows phone/i.test(e)||$e(e)}function Qe(e,t=[]){let n;switch(e){case"Browser":n=je(s());break;case"Worker":n=`${je(s())}-${e}`;break;default:n=e}return`${n}/JsCore/9.6.6/${t.length?t.join(","):"FirebaseCore-web"}`}class Xe{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ze(this),this.idTokenSubscription=new Ze(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Y,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=le(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Ve.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);r&&r!==i||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Oe(e)}catch(e){if("auth/network-request-failed"!==e.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?b(e):null;return t&&oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(le(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new h("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&le(e)||this._popupRedirectResolver;oe(t,this,"argument-error"),this.redirectPersistenceManager=await Ve.create(this,[le(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return oe(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Qe(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};return this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId),e}}function Ye(e){return b(e)}class Ze{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new v(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class et{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ae("not implemented")}_getIdTokenResponse(e){return ae("not implemented")}_linkToIdToken(e,t){return ae("not implemented")}_getReauthenticationResolver(e){return ae("not implemented")}}async function tt(e,t){return be(e,"POST","/v1/accounts:update",t)}class nt extends et{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new nt(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new nt(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return _e(e,"POST","/v1/accounts:signInWithPassword",we(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return _e(e,"POST","/v1/accounts:signInWithEmailLink",we(e,t))}(e,{email:this._email,oobCode:this._password});default:te(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return tt(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return _e(e,"POST","/v1/accounts:signInWithEmailLink",we(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:te(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function rt(e,t){return _e(e,"POST","/v1/accounts:signInWithIdp",we(e,t))}class it extends et{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new it(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):te("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=J(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new it(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return rt(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,rt(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,rt(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=g(t)}return e}}const st={USER_NOT_FOUND:"user-not-found"};class ot extends et{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ot({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ot({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return _e(e,"POST","/v1/accounts:signInWithPhoneNumber",we(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await _e(e,"POST","/v1/accounts:signInWithPhoneNumber",we(e,t));if(n.temporaryProof)throw Se(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return _e(e,"POST","/v1/accounts:signInWithPhoneNumber",we(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),st)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new ot({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class at{constructor(e){var t,n,r,i,s,o;const a=m(y(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);oe(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=m(y(e)).link,n=t?m(y(t)).deep_link_id:null,r=m(y(e)).deep_link_id;return(r?m(y(r)).link:null)||r||n||t||e}(e);try{return new at(t)}catch(e){return null}}}class ct{constructor(){this.providerId=ct.PROVIDER_ID}static credential(e,t){return nt._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=at.parseLink(t);return oe(n,"argument-error"),nt._fromEmailAndCode(e,n.code,n.tenantId)}}ct.PROVIDER_ID="password",ct.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ct.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ut{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class lt extends ut{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ht extends lt{constructor(){super("facebook.com")}static credential(e){return it._fromParams({providerId:ht.PROVIDER_ID,signInMethod:ht.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ht.credentialFromTaggedObject(e)}static credentialFromError(e){return ht.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ht.credential(e.oauthAccessToken)}catch(e){return null}}}ht.FACEBOOK_SIGN_IN_METHOD="facebook.com",ht.PROVIDER_ID="facebook.com";class dt extends lt{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return it._fromParams({providerId:dt.PROVIDER_ID,signInMethod:dt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return dt.credentialFromTaggedObject(e)}static credentialFromError(e){return dt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return dt.credential(t,n)}catch(e){return null}}}dt.GOOGLE_SIGN_IN_METHOD="google.com",dt.PROVIDER_ID="google.com";class ft extends lt{constructor(){super("github.com")}static credential(e){return it._fromParams({providerId:ft.PROVIDER_ID,signInMethod:ft.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ft.credentialFromTaggedObject(e)}static credentialFromError(e){return ft.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ft.credential(e.oauthAccessToken)}catch(e){return null}}}ft.GITHUB_SIGN_IN_METHOD="github.com",ft.PROVIDER_ID="github.com";class pt extends lt{constructor(){super("twitter.com")}static credential(e,t){return it._fromParams({providerId:pt.PROVIDER_ID,signInMethod:pt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return pt.credentialFromTaggedObject(e)}static credentialFromError(e){return pt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return pt.credential(t,n)}catch(e){return null}}}pt.TWITTER_SIGN_IN_METHOD="twitter.com",pt.PROVIDER_ID="twitter.com";class gt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Me._fromIdTokenResponse(e,n,r),s=mt(n);return new gt({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=mt(n);return new gt({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function mt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class yt extends l{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,yt.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new yt(e,t,n,r)}}function vt(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw yt._fromErrorAndOperation(e,n,t,r);throw n}))}async function wt(e,t,n=!1){const r=await Ne(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return gt._forOperation(e,"link",r)}async function bt(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await Ne(e,vt(r,i,t,e),n);oe(s.idToken,r,"internal-error");const o=Ce(s.idToken);oe(o,r,"internal-error");const{sub:a}=o;return oe(e.uid===a,r,"user-mismatch"),gt._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&te(r,"user-mismatch"),e}}async function Tt(e,t,n=!1){const r="signIn",i=await vt(e,r,t),s=await gt._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}new WeakMap;const _t="__sak";class It{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(_t,"1"),this.storage.removeItem(_t),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Et extends It{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=s();return Be(e)||Ge(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Je(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);u()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Et.type="LOCAL";const St=Et;class kt extends It{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}kt.type="SESSION";const At=kt;class Ct{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Ct(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Nt(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Ct.receivers=[];class Rt{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=Nt("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Dt(){return window}function Ot(){return void 0!==Dt().WorkerGlobalScope&&"function"==typeof Dt().importScripts}const Pt="firebaseLocalStorageDb",Lt="firebaseLocalStorage",Mt="fbase_key";class xt{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Ut(e,t){return e.transaction([Lt],t?"readwrite":"readonly").objectStore(Lt)}function Ft(){const e=indexedDB.open(Pt,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Lt,{keyPath:Mt})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Lt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Pt);return new xt(e).toPromise()}(),t(await Ft()))}))}))}async function Vt(e,t,n){const r=Ut(e,!0).put({[Mt]:t,value:n});return new xt(r).toPromise()}function jt(e,t){const n=Ut(e,!0).delete(t);return new xt(n).toPromise()}class qt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Ft()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ot()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ct._getInstance(Ot()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Rt(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ft();return await Vt(e,_t,"1"),await jt(e,_t),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Vt(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Ut(e,!1).get(t),r=await new xt(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>jt(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Ut(e,!1).getAll();return new xt(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}qt.type="LOCAL";const Bt=qt;function Kt(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=ne("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function $t(e){return`__${e}${Math.floor(1e6*Math.random())}`}$t("rcb"),new pe(3e4,6e4);const Ht="recaptcha";async function zt(e,t,n){var r;const i=await n.verify();try{let s;if(oe("string"==typeof i,e,"argument-error"),oe(n.type===Ht,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){oe("enroll"===t.type,e,"internal-error");const n=await function(e,t){return be(e,"POST","/v2/accounts/mfaEnrollment:start",we(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{oe("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;oe(n,e,"missing-multi-factor-info");const o=await function(e,t){return be(e,"POST","/v2/accounts/mfaSignIn:start",we(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return be(e,"POST","/v1/accounts:sendVerificationCode",we(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class Wt{constructor(e){this.providerId=Wt.PROVIDER_ID,this.auth=Ye(e)}verifyPhoneNumber(e,t){return zt(this.auth,e,b(t))}static credential(e,t){return ot._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Wt.credentialFromTaggedObject(t)}static credentialFromError(e){return Wt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?ot._fromTokenResponse(t,n):null}}function Gt(e,t){return t?le(t):(oe(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Wt.PROVIDER_ID="phone",Wt.PHONE_SIGN_IN_METHOD="phone";class Jt extends et{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rt(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rt(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rt(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Qt(e){return Tt(e.auth,new Jt(e),e.bypassAuthState)}function Xt(e){const{auth:t,user:n}=e;return oe(n,t,"internal-error"),bt(n,new Jt(e),e.bypassAuthState)}async function Yt(e){const{auth:t,user:n}=e;return oe(n,t,"internal-error"),wt(n,new Jt(e),e.bypassAuthState)}class Zt{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Qt;case"linkViaPopup":case"linkViaRedirect":return Yt;case"reauthViaPopup":case"reauthViaRedirect":return Xt;default:te(this.auth,"internal-error")}}resolve(e){ce(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ce(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const en=new pe(2e3,1e4);class tn extends Zt{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,tn.currentPopupAction&&tn.currentPopupAction.cancel(),tn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return oe(e,this.auth,"internal-error"),e}async onExecution(){ce(1===this.filter.length,"Popup operations only handle one event");const e=Nt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(ne(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(ne(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tn.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(ne(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,en.get())};e()}}tn.currentPopupAction=null;const nn=new Map;class rn extends Zt{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=nn.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=on(t),r=sn(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}nn.set(this.auth._key(),e)}return this.bypassAuthState||nn.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function sn(e){return le(e._redirectPersistence)}function on(e){return Fe("pendingRedirect",e.config.apiKey,e.name)}async function an(e,t,n=!1){const r=Ye(e),i=Gt(r,t),s=new rn(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class cn{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ln(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!ln(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ne(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(un(e))}saveEventToCache(e){this.cachedEventUids.add(un(e)),this.lastProcessedEventTime=Date.now()}}function un(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function ln({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const hn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dn=/^https?/;async function fn(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return be(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(pn(e))return}catch(e){}te(e,"unauthorized-domain")}function pn(e){const t=he(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!dn.test(n))return!1;if(hn.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const gn=new pe(3e4,6e4);function mn(){const e=Dt().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let yn=null;function vn(e){return yn=yn||function(e){return new Promise(((t,n)=>{var r,i,s;function o(){mn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{mn(),n(ne(e,"network-request-failed"))},timeout:gn.get()})}if(null===(i=null===(r=Dt().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Dt().gapi)||void 0===s?void 0:s.load)){const t=$t("iframefcb");return Dt()[t]=()=>{gapi.load?o():n(ne(e,"network-request-failed"))},Kt(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw yn=null,e}))}(e),yn}const wn=new pe(5e3,15e3),bn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Tn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _n(e){const t=e.config;oe(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?ge(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:H},i=Tn.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${g(r).slice(1)}`}const In={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class En{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Sn(e,t,n,r=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},In),{width:r.toString(),height:i.toString(),top:o,left:a}),l=s().toLowerCase();n&&(c=Ke(l)?"_blank":n),qe(l)&&(t=t||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=s()){var t;return Ge(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new En(null);const d=window.open(t||"",c,h);oe(d,e,"popup-blocked");try{d.focus()}catch(e){}return new En(d)}const kn="__/auth/handler",An="emulator/auth/handler";function Cn(e,t,n,r,i,s){oe(e.config.authDomain,e,"auth-domain-config-required"),oe(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:H,eventId:i};if(t instanceof ut){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof lt){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${kn}`;return ge(e,An)}(e)}?${g(a).slice(1)}`}const Nn="webStorageSupport";const Rn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=At,this._completeRedirectFn=an}async _openPopup(e,t,n,r){var i;ce(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Sn(e,Cn(e,t,n,he(),r),Nt())}async _openRedirect(e,t,n,r){var i;return await this._originValidation(e),i=Cn(e,t,n,he(),r),Dt().location.href=i,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(ce(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await vn(e),n=Dt().gapi;return oe(n,e,"internal-error"),t.open({where:document.body,url:_n(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bn,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=ne(e,"network-request-failed"),s=Dt().setTimeout((()=>{r(i)}),wn.get());function o(){Dt().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new cn(e);return t.register("authEvent",(t=>{oe(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Nn,{type:Nn},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),te(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=fn(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Je()||Be()||Ge()}};var Dn,On="@firebase/auth",Pn="0.19.8";class Ln{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Mn(e=z()){const t=B(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){const n=B(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(f(n.getOptions(),null!=t?t:{}))return e;te(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Rn,persistence:[Bt,St,At]})}Dn="Browser",q(new T("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),{apiKey:r,authDomain:i}=n.options;return(e=>{oe(r&&!r.includes(":"),"invalid-api-key",{appName:e.name}),oe(!(null==i?void 0:i.includes(":")),"argument-error",{appName:e.name});const n={apiKey:r,authDomain:i,clientPlatform:Dn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qe(Dn)},s=new Xe(e,n);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(le);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(s,t),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),q(new T("auth-internal",(e=>(e=>new Ln(e))(Ye(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),W(On,Pn,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Dn)),W(On,Pn,"esm2017");var xn,Un="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},Fn={},Vn=Vn||{},jn=Un||self;function qn(){}function Bn(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Kn(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var $n="closure_uid_"+(1e9*Math.random()>>>0),Hn=0;function zn(e,t,n){return e.call.apply(e.bind,arguments)}function Wn(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Gn(e,t,n){return(Gn=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?zn:Wn).apply(null,arguments)}function Jn(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Qn(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function Xn(){this.s=this.s,this.o=this.o}var Yn={};Xn.prototype.s=!1,Xn.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,$n)&&e[$n]||(e[$n]=++Hn)}(this);delete Yn[e]}},Xn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Zn=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},er=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){const r=e.length,i="string"==typeof e?e.split(""):e;for(let s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function tr(e){return Array.prototype.concat.apply([],arguments)}function nr(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function rr(e){return/^[\s\xa0]*$/.test(e)}var ir,sr=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function or(e,t){return-1!=e.indexOf(t)}function ar(e,t){return e<t?-1:e>t?1:0}e:{var cr=jn.navigator;if(cr){var ur=cr.userAgent;if(ur){ir=ur;break e}}ir=""}function lr(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function hr(e){const t={};for(const n in e)t[n]=e[n];return t}var dr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fr(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<dr.length;t++)n=dr[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function pr(e){return pr[" "](e),e}pr[" "]=qn;var gr,mr,yr=or(ir,"Opera"),vr=or(ir,"Trident")||or(ir,"MSIE"),wr=or(ir,"Edge"),br=wr||vr,Tr=or(ir,"Gecko")&&!(or(ir.toLowerCase(),"webkit")&&!or(ir,"Edge"))&&!(or(ir,"Trident")||or(ir,"MSIE"))&&!or(ir,"Edge"),_r=or(ir.toLowerCase(),"webkit")&&!or(ir,"Edge");function Ir(){var e=jn.document;return e?e.documentMode:void 0}e:{var Er="",Sr=(mr=ir,Tr?/rv:([^\);]+)(\)|;)/.exec(mr):wr?/Edge\/([\d\.]+)/.exec(mr):vr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(mr):_r?/WebKit\/(\S+)/.exec(mr):yr?/(?:Version)[ \/]?(\S+)/.exec(mr):void 0);if(Sr&&(Er=Sr?Sr[1]:""),vr){var kr=Ir();if(null!=kr&&kr>parseFloat(Er)){gr=String(kr);break e}}gr=Er}var Ar,Cr={};function Nr(){return function(e){var t=Cr;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){let e=0;const t=sr(String(gr)).split("."),n=sr("9").split("."),r=Math.max(t.length,n.length);for(let o=0;0==e&&o<r;o++){var i=t[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;e=ar(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||ar(0==i[2].length,0==s[2].length)||ar(i[2],s[2]),i=i[3],s=s[3]}while(0==e)}return 0<=e}))}if(jn.document&&vr){var Rr=Ir();Ar=Rr||(parseInt(gr,10)||void 0)}else Ar=void 0;var Dr=Ar,Or=function(){if(!jn.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{jn.addEventListener("test",qn,t),jn.removeEventListener("test",qn,t)}catch(e){}return e}();function Pr(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function Lr(e,t){if(Pr.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Tr){e:{try{pr(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Mr[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Lr.Z.h.call(this)}}Pr.prototype.h=function(){this.defaultPrevented=!0},Qn(Lr,Pr);var Mr={2:"touch",3:"pen",4:"mouse"};Lr.prototype.h=function(){Lr.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var xr="closure_listenable_"+(1e6*Math.random()|0),Ur=0;function Fr(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++Ur,this.ca=this.fa=!1}function Vr(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function jr(e){this.src=e,this.g={},this.h=0}function qr(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Zn(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(Vr(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Br(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return i}return-1}jr.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Br(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new Fr(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var Kr="closure_lm_"+(1e6*Math.random()|0),$r={};function Hr(e,t,n,r,i){if(r&&r.once)return Wr(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)Hr(e,t[s],n,r,i);return null}return n=ei(n),e&&e[xr]?e.N(t,n,Kn(r)?!!r.capture:!!r,i):zr(e,t,n,!1,r,i)}function zr(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=Kn(i)?!!i.capture:!!i,a=Yr(e);if(a||(e[Kr]=a=new jr(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Xr;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Or||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Qr(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Wr(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Wr(e,t[s],n,r,i);return null}return n=ei(n),e&&e[xr]?e.O(t,n,Kn(r)?!!r.capture:!!r,i):zr(e,t,n,!0,r,i)}function Gr(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Gr(e,t[s],n,r,i);else r=Kn(r)?!!r.capture:!!r,n=ei(n),e&&e[xr]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Br(s=e.g[t],n,r,i))&&(Vr(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Yr(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Br(t,n,r,i)),(n=-1<e?t[e]:null)&&Jr(n))}function Jr(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[xr])qr(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Qr(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Yr(t))?(qr(n,e),0==n.h&&(n.src=null,t[Kr]=null)):Vr(e)}}}function Qr(e){return e in $r?$r[e]:$r[e]="on"+e}function Xr(e,t){if(e.ca)e=!0;else{t=new Lr(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&Jr(e),e=n.call(r,t)}return e}function Yr(e){return(e=e[Kr])instanceof jr?e:null}var Zr="__closure_events_fn_"+(1e9*Math.random()>>>0);function ei(e){return"function"==typeof e?e:(e[Zr]||(e[Zr]=function(t){return e.handleEvent(t)}),e[Zr])}function ti(){Xn.call(this),this.i=new jr(this),this.P=this,this.I=null}function ni(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new Pr(t,e);else if(t instanceof Pr)t.target=t.target||e;else{var i=t;fr(t=new Pr(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=ri(o,r,!0,t)&&i}if(i=ri(o=t.g=e,r,!0,t)&&i,i=ri(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ri(o=t.g=n[s],r,!1,t)&&i}function ri(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&qr(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}Qn(ti,Xn),ti.prototype[xr]=!0,ti.prototype.removeEventListener=function(e,t,n,r){Gr(this,e,t,n,r)},ti.prototype.M=function(){if(ti.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Vr(n[r]);delete t.g[e],t.h--}}this.I=null},ti.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ti.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var ii=jn.JSON.stringify;function si(){var e=di;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var oi,ai=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new ci),(e=>e.reset()));class ci{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function ui(e){jn.setTimeout((()=>{throw e}),0)}function li(e,t){oi||function(){var e=jn.Promise.resolve(void 0);oi=function(){e.then(fi)}}(),hi||(oi(),hi=!0),di.add(e,t)}var hi=!1,di=new class{constructor(){this.h=this.g=null}add(e,t){const n=ai.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function fi(){for(var e;e=si();){try{e.h.call(e.g)}catch(e){ui(e)}var t=ai;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}hi=!1}function pi(e,t){ti.call(this),this.h=e||1,this.g=t||jn,this.j=Gn(this.kb,this),this.l=Date.now()}function gi(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function mi(e,t,n){if("function"==typeof e)n&&(e=Gn(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Gn(e.handleEvent,e)}return 2147483647<Number(t)?-1:jn.setTimeout(e,t||0)}function yi(e){e.g=mi((()=>{e.g=null,e.i&&(e.i=!1,yi(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}Qn(pi,ti),(xn=pi.prototype).da=!1,xn.S=null,xn.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),ni(this,"tick"),this.da&&(gi(this),this.start()))}},xn.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},xn.M=function(){pi.Z.M.call(this),gi(this),delete this.g};class vi extends Xn{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:yi(this)}M(){super.M(),this.g&&(jn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function wi(e){Xn.call(this),this.h=e,this.g={}}Qn(wi,Xn);var bi=[];function Ti(e,t,n,r){Array.isArray(n)||(n&&(bi[0]=n.toString()),n=bi);for(var i=0;i<n.length;i++){var s=Hr(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function _i(e){lr(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Jr(e)}),e),e.g={}}function Ii(){this.g=!0}function Ei(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return ii(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}wi.prototype.M=function(){wi.Z.M.call(this),_i(this)},wi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ii.prototype.Aa=function(){this.g=!1},Ii.prototype.info=function(){};var Si={},ki=null;function Ai(){return ki=ki||new ti}function Ci(e){Pr.call(this,Si.Ma,e)}function Ni(e){const t=Ai();ni(t,new Ci(t,e))}function Ri(e,t){Pr.call(this,Si.STAT_EVENT,e),this.stat=t}function Di(e){const t=Ai();ni(t,new Ri(t,e))}function Oi(e,t){Pr.call(this,Si.Na,e),this.size=t}function Pi(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return jn.setTimeout((function(){e()}),t)}Si.Ma="serverreachability",Qn(Ci,Pr),Si.STAT_EVENT="statevent",Qn(Ri,Pr),Si.Na="timingevent",Qn(Oi,Pr);var Li={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Mi={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function xi(){}function Ui(e){return e.h||(e.h=e.i())}function Fi(){}xi.prototype.h=null;var Vi,ji={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function qi(){Pr.call(this,"d")}function Bi(){Pr.call(this,"c")}function Ki(){}function $i(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new wi(this),this.P=zi,e=br?125:void 0,this.W=new pi(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Hi}function Hi(){this.i=null,this.g="",this.h=!1}Qn(qi,Pr),Qn(Bi,Pr),Qn(Ki,xi),Ki.prototype.g=function(){return new XMLHttpRequest},Ki.prototype.i=function(){return{}},Vi=new Ki;var zi=45e3,Wi={},Gi={};function Ji(e,t,n){e.K=1,e.v=vs(ds(t)),e.s=n,e.U=!0,Qi(e,null)}function Qi(e,t){e.F=Date.now(),es(e),e.A=ds(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),Ds(n.h,"t",r),e.C=0,n=e.l.H,e.h=new Hi,e.g=Oo(e.l,n?t:null,!e.s),0<e.O&&(e.L=new vi(Gn(e.Ia,e,e.g),e.O)),Ti(e.V,e.g,"readystatechange",e.gb),t=e.H?hr(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ni(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function Xi(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function Yi(e,t,n){let r,i=!0;for(;!e.I&&e.C<n.length;){if(r=Zi(e,n),r==Gi){4==t&&(e.o=4,Di(14),i=!1),Ei(e.j,e.m,null,"[Incomplete Response]");break}if(r==Wi){e.o=4,Di(15),Ei(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ei(e.j,e.m,r,null),ss(e,r)}Xi(e)&&r!=Gi&&r!=Wi&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Di(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Eo(t),t.L=!0,Di(11))):(Ei(e.j,e.m,n,"[Invalid Chunked Response]"),is(e),rs(e))}function Zi(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Gi:(n=Number(t.substring(n,r)),isNaN(n)?Wi:(r+=1)+n>t.length?Gi:(t=t.substr(r,n),e.C=r+n,t))}function es(e){e.Y=Date.now()+e.P,ts(e,e.P)}function ts(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Pi(Gn(e.eb,e),t)}function ns(e){e.B&&(jn.clearTimeout(e.B),e.B=null)}function rs(e){0==e.l.G||e.I||Ao(e.l,e)}function is(e){ns(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,gi(e.W),_i(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function ss(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||Us(n.i,e)))if(n.I=e.N,!e.J&&Us(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;ko(n),go(n)}Io(n),Di(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Pi(Gn(n.ab,n),6e3));if(1>=xs(n.i)&&n.ka){try{n.ka()}catch(e){}n.ka=void 0}}else No(n,11)}else if((e.J||n.g==e)&&ko(n),!rr(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.U=u[0],u=u[1],2==n.G)if("c"==u[0]){n.J=u[1],n.la=u[2];const t=u[3];null!=t&&(n.ma=t,n.h.info("VER="+n.ma));const i=u[4];null!=i&&(n.za=i,n.h.info("SVER="+n.za));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(r=1.5*l,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;!s.g&&(or(e,"spdy")||or(e,"quic")||or(e,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(Fs(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.sa=e,ys(r.F,r.D,e))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=e;if((r=n).oa=Do(r,r.H?r.la:null,r.W),o.J){Vs(r.i,o);var a=o,c=r.K;c&&a.setTimeout(c),a.B&&(ns(a),es(a)),r.g=o}else _o(r);0<n.l.length&&vo(n)}else"stop"!=u[0]&&"close"!=u[0]||No(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?No(n,7):po(n):"noop"!=u[0]&&n.j&&n.j.wa(u),n.A=0)}Ni(4)}catch(e){}}function os(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Bn(e)||"string"==typeof e)er(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(Bn(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(Bn(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function as(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof as)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function cs(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];us(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)us(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function us(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(xn=$i.prototype).setTimeout=function(e){this.P=e},xn.gb=function(e){e=e.target;const t=this.L;t&&3==co(e)?t.l():this.Ia(e)},xn.Ia=function(e){try{if(e==this.g)e:{const l=co(this.g);var t=this.g.Da();const h=this.g.ba();if(!(3>l)&&(3!=l||br||this.g&&(this.h.h||this.g.ga()||uo(this.g)))){this.I||4!=l||7==t||Ni(8==t||0>=h?3:2),ns(this);var n=this.g.ba();this.N=n;t:if(Xi(this)){var r=uo(this.g);e="";var i=r.length,s=4==co(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){is(this),rs(this);var o="";break t}this.h.i=new jn.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,l,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!rr(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,Di(12),is(this),rs(this);break e}Ei(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ss(this,n)}this.U?(Yi(this,l,o),br&&this.i&&3==l&&(Ti(this.V,this.W,"tick",this.fb),this.W.start())):(Ei(this.j,this.m,o,null),ss(this,o)),4==l&&is(this),this.i&&!this.I&&(4==l?Ao(this.l,this):(this.i=!1,es(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Di(12)):(this.o=0,Di(13)),is(this),rs(this)}}}catch(e){}},xn.fb=function(){if(this.g){var e=co(this.g),t=this.g.ga();this.C<t.length&&(ns(this),Yi(this,e,t),this.i&&4!=e&&es(this))}},xn.cancel=function(){this.I=!0,is(this)},xn.eb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(Ni(3),Di(17)),is(this),this.o=2,rs(this)):ts(this,this.Y-e)},(xn=as.prototype).R=function(){cs(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},xn.T=function(){return cs(this),this.g.concat()},xn.get=function(e,t){return us(this.h,e)?this.h[e]:t},xn.set=function(e,t){us(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},xn.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var ls=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function hs(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof hs){this.g=void 0!==t?t:e.g,fs(this,e.j),this.s=e.s,ps(this,e.i),gs(this,e.m),this.l=e.l,t=e.h;var n=new As;n.i=t.i,t.g&&(n.g=new as(t.g),n.h=t.h),ms(this,n),this.o=e.o}else e&&(n=String(e).match(ls))?(this.g=!!t,fs(this,n[1]||"",!0),this.s=ws(n[2]||""),ps(this,n[3]||"",!0),gs(this,n[4]),this.l=ws(n[5]||"",!0),ms(this,n[6]||"",!0),this.o=ws(n[7]||"")):(this.g=!!t,this.h=new As(null,this.g))}function ds(e){return new hs(e)}function fs(e,t,n){e.j=n?ws(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ps(e,t,n){e.i=n?ws(t,!0):t}function gs(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function ms(e,t,n){t instanceof As?(e.h=t,function(e,t){t&&!e.j&&(Cs(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Ns(this,t),Ds(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=bs(t,Ss)),e.h=new As(t,e.g))}function ys(e,t,n){e.h.set(t,n)}function vs(e){return ys(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ws(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function bs(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Ts),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ts(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}hs.prototype.toString=function(){var e=[],t=this.j;t&&e.push(bs(t,_s,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(bs(t,_s,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(bs(n,"/"==n.charAt(0)?Es:Is,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",bs(n,ks)),e.join("")};var _s=/[#\/\?@]/g,Is=/[#\?:]/g,Es=/[#\?]/g,Ss=/[#\?@]/g,ks=/#/g;function As(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Cs(e){e.g||(e.g=new as,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Ns(e,t){Cs(e),t=Os(e,t),us(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,us((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&cs(e)))}function Rs(e,t){return Cs(e),t=Os(e,t),us(e.g.h,t)}function Ds(e,t,n){Ns(e,t),0<n.length&&(e.i=null,e.g.set(Os(e,t),nr(n)),e.h+=n.length)}function Os(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(xn=As.prototype).add=function(e,t){Cs(this),this.i=null,e=Os(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},xn.forEach=function(e,t){Cs(this),this.g.forEach((function(n,r){er(n,(function(n){e.call(t,n,r,this)}),this)}),this)},xn.T=function(){Cs(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},xn.R=function(e){Cs(this);var t=[];if("string"==typeof e)Rs(this,e)&&(t=tr(t,this.g.get(Os(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=tr(t,e[n])}return t},xn.set=function(e,t){return Cs(this),this.i=null,Rs(this,e=Os(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},xn.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},xn.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};function Ps(e){this.l=e||Ls,jn.PerformanceNavigationTiming?e=0<(e=jn.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(jn.g&&jn.g.Ea&&jn.g.Ea()&&jn.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ls=10;function Ms(e){return!!e.h||!!e.g&&e.g.size>=e.j}function xs(e){return e.h?1:e.g?e.g.size:0}function Us(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Fs(e,t){e.g?e.g.add(t):e.h=t}function Vs(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function js(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return nr(e.i)}function qs(){}function Bs(){this.g=new qs}function Ks(e,t,n){const r=n||"";try{os(e,(function(e,n){let i=e;Kn(e)&&(i=ii(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function $s(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function Hs(e){this.l=e.$b||null,this.j=e.ib||!1}function zs(e,t){ti.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Ws,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ps.prototype.cancel=function(){if(this.i=js(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},qs.prototype.stringify=function(e){return jn.JSON.stringify(e,void 0)},qs.prototype.parse=function(e){return jn.JSON.parse(e,void 0)},Qn(Hs,xi),Hs.prototype.g=function(){return new zs(this.l,this.j)},Hs.prototype.i=function(e){return function(){return e}}({}),Qn(zs,ti);var Ws=0;function Gs(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function Js(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Qs(e)}function Qs(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(xn=zs.prototype).open=function(e,t){if(this.readyState!=Ws)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Qs(this)},xn.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||jn).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},xn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Js(this)),this.readyState=Ws},xn.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Qs(this)),this.g&&(this.readyState=3,Qs(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==jn.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Gs(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},xn.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Js(this):Qs(this),3==this.readyState&&Gs(this)}},xn.Ua=function(e){this.g&&(this.response=this.responseText=e,Js(this))},xn.Ta=function(e){this.g&&(this.response=e,Js(this))},xn.ha=function(){this.g&&Js(this)},xn.setRequestHeader=function(e,t){this.v.append(e,t)},xn.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},xn.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(zs.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Xs=jn.JSON.parse;function Ys(e){ti.call(this),this.headers=new as,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Zs,this.K=this.L=!1}Qn(Ys,ti);var Zs="",eo=/^https?$/i,to=["POST","PUT"];function no(e){return"content-type"==e.toLowerCase()}function ro(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,io(e),oo(e)}function io(e){e.D||(e.D=!0,ni(e,"complete"),ni(e,"error"))}function so(e){if(e.h&&void 0!==Vn&&(!e.C[1]||4!=co(e)||2!=e.ba()))if(e.v&&4==co(e))mi(e.Fa,0,e);else if(ni(e,"readystatechange"),4==co(e)){e.h=!1;try{const a=e.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){var i=String(e.H).match(ls)[1]||null;if(!i&&jn.self&&jn.self.location){var s=jn.self.location.protocol;i=s.substr(0,s.length-1)}r=!eo.test(i?i.toLowerCase():"")}n=r}if(n)ni(e,"complete"),ni(e,"success");else{e.m=6;try{var o=2<co(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.ba()+"]",io(e)}}finally{oo(e)}}}function oo(e,t){if(e.g){ao(e);const n=e.g,r=e.C[0]?qn:null;e.g=null,e.C=null,t||ni(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function ao(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(jn.clearTimeout(e.A),e.A=null)}function co(e){return e.g?e.g.readyState:0}function uo(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Zs:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function lo(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){let t="";return lr(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):ys(e,t,n))}function ho(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function fo(e){this.za=0,this.l=[],this.h=new Ii,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=ho("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=ho("baseRetryDelayMs",5e3,e),this.$a=ho("retryDelaySeedMs",1e4,e),this.Ya=ho("forwardChannelMaxRetries",2,e),this.ra=ho("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new Ps(e&&e.concurrentRequestLimit),this.Ca=new Bs,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function po(e){if(mo(e),3==e.G){var t=e.V++,n=ds(e.F);ys(n,"SID",e.J),ys(n,"RID",t),ys(n,"TYPE","terminate"),bo(e,n),(t=new $i(e,e.h,t,void 0)).K=2,t.v=vs(ds(n)),n=!1,jn.navigator&&jn.navigator.sendBeacon&&(n=jn.navigator.sendBeacon(t.v.toString(),"")),!n&&jn.Image&&((new Image).src=t.v,n=!0),n||(t.g=Oo(t.l,null),t.g.ea(t.v)),t.F=Date.now(),es(t)}Ro(e)}function go(e){e.g&&(Eo(e),e.g.cancel(),e.g=null)}function mo(e){go(e),e.u&&(jn.clearTimeout(e.u),e.u=null),ko(e),e.i.cancel(),e.m&&("number"==typeof e.m&&jn.clearTimeout(e.m),e.m=null)}function yo(e,t){e.l.push(new class{constructor(e,t){this.h=e,this.g=t}}(e.Za++,t)),3==e.G&&vo(e)}function vo(e){Ms(e.i)||e.m||(e.m=!0,li(e.Ha,e),e.C=0)}function wo(e,t){var n;n=t?t.m:e.V++;const r=ds(e.F);ys(r,"SID",e.J),ys(r,"RID",n),ys(r,"AID",e.U),bo(e,r),e.o&&e.s&&lo(r,e.o,e.s),n=new $i(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=To(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),Fs(e.i,n),Ji(n,r,t)}function bo(e,t){e.j&&os({},(function(e,n){ys(t,n,e)}))}function To(e,t,n){n=Math.min(e.l.length,n);var r=e.j?Gn(e.j.Oa,e.j,e):null;e:{var i=e.l;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].h;const a=i[o].g;if(n-=t,0>n)t=Math.max(0,i[o].h-100),s=!1;else try{Ks(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.l.splice(0,n),t.D=e,r}function _o(e){e.g||e.u||(e.Y=1,li(e.Ga,e),e.A=0)}function Io(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=Pi(Gn(e.Ga,e),Co(e,e.A)),e.A++,!0)}function Eo(e){null!=e.B&&(jn.clearTimeout(e.B),e.B=null)}function So(e){e.g=new $i(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=ds(e.oa);ys(t,"RID","rpc"),ys(t,"SID",e.J),ys(t,"CI",e.N?"0":"1"),ys(t,"AID",e.U),bo(e,t),ys(t,"TYPE","xmlhttp"),e.o&&e.s&&lo(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=vs(ds(t)),n.s=null,n.U=!0,Qi(n,e)}function ko(e){null!=e.v&&(jn.clearTimeout(e.v),e.v=null)}function Ao(e,t){var n=null;if(e.g==t){ko(e),Eo(e),e.g=null;var r=2}else{if(!Us(e.i,t))return;n=t.D,Vs(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;ni(r=Ai(),new Oi(r,n,t,i)),vo(e)}else _o(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(xs(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=Pi(Gn(e.Ha,e,t),Co(e,e.C)),e.C++,0)))}(e,t)||2==r&&Io(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:No(e,5);break;case 4:No(e,10);break;case 3:No(e,6);break;default:No(e,2)}}function Co(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function No(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=Gn(e.jb,e);n||(n=new hs("//www.google.com/images/cleardot.gif"),jn.location&&"http"==jn.location.protocol||fs(n,"https"),vs(n)),function(e,t){const n=new Ii;if(jn.Image){const r=new Image;r.onload=Jn($s,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Jn($s,n,r,"TestLoadImage: error",!1,t),r.onabort=Jn($s,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Jn($s,n,r,"TestLoadImage: timeout",!1,t),jn.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Di(2);e.G=0,e.j&&e.j.va(t),Ro(e),mo(e)}function Ro(e){e.G=0,e.I=-1,e.j&&(0==js(e.i).length&&0==e.l.length||(e.i.i.length=0,nr(e.l),e.l.length=0),e.j.ua())}function Do(e,t,n){let r=function(e){return e instanceof hs?ds(e):new hs(e,void 0)}(n);if(""!=r.i)t&&ps(r,t+"."+r.i),gs(r,r.m);else{const e=jn.location;r=function(e,t,n,r){var i=new hs(null,void 0);return e&&fs(i,e),t&&ps(i,t),n&&gs(i,n),r&&(i.l=r),i}(e.protocol,t?t+"."+e.hostname:e.hostname,+e.port,n)}return e.aa&&lr(e.aa,(function(e,t){ys(r,t,e)})),t=e.D,n=e.sa,t&&n&&ys(r,t,n),ys(r,"VER",e.ma),bo(e,r),r}function Oo(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new Ys(new Hs({ib:!0})):new Ys(e.qa)).L=e.H,t}function Po(){}function Lo(){if(vr&&!(10<=Number(Dr)))throw Error("Environmental error: no available transport.")}function Mo(e,t){ti.call(this),this.g=new fo(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!rr(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!rr(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Fo(this)}function xo(e){qi.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Uo(){Bi.call(this),this.status=1}function Fo(e){this.g=e}(xn=Ys.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Vi.g(),this.C=this.u?Ui(this.u):Ui(Vi),this.g.onreadystatechange=Gn(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void ro(this,e)}e=n||"";const i=new as(this.headers);r&&os(r,(function(e,t){i.set(t,e)})),r=function(e){e:{var t=no;const n=e.length,r="string"==typeof e?e.split(""):e;for(let i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=jn.FormData&&e instanceof jn.FormData,!(0<=Zn(to,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ao(this),0<this.B&&((this.K=function(e){return vr&&Nr()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Gn(this.pa,this)):this.A=mi(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){ro(this,e)}},xn.pa=function(){void 0!==Vn&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ni(this,"timeout"),this.abort(8))},xn.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,ni(this,"complete"),ni(this,"abort"),oo(this))},xn.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),oo(this,!0)),Ys.Z.M.call(this)},xn.Fa=function(){this.s||(this.F||this.v||this.l?so(this):this.cb())},xn.cb=function(){so(this)},xn.ba=function(){try{return 2<co(this)?this.g.status:-1}catch(e){return-1}},xn.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},xn.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Xs(t)}},xn.Da=function(){return this.m},xn.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(xn=fo.prototype).ma=8,xn.G=1,xn.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(e){}},xn.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new $i(this,this.h,e,void 0);let s=this.s;if(this.P&&(s?(s=hr(s),fr(s,this.P)):s=this.P),null===this.o&&(i.H=s),this.ja)e:{for(var t=0,n=0;n<this.l.length;n++){var r=this.l[n];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.l.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=To(this,i,t),ys(n=ds(this.F),"RID",e),ys(n,"CVER",22),this.D&&ys(n,"X-HTTP-Session-Id",this.D),bo(this,n),this.o&&s&&lo(n,this.o,s),Fs(this.i,i),this.Ra&&ys(n,"TYPE","init"),this.ja?(ys(n,"$req",t),ys(n,"SID","null"),i.$=!0,Ji(i,n,null)):Ji(i,n,t),this.G=2}}else 3==this.G&&(e?wo(this,e):0==this.l.length||Ms(this.i)||wo(this))},xn.Ga=function(){if(this.u=null,So(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=Pi(Gn(this.bb,this),e)}},xn.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Di(10),go(this),So(this))},xn.ab=function(){null!=this.v&&(this.v=null,go(this),Io(this),Di(19))},xn.jb=function(e){e?(this.h.info("Successfully pinged google.com"),Di(2)):(this.h.info("Failed to ping google.com"),Di(1))},(xn=Po.prototype).xa=function(){},xn.wa=function(){},xn.va=function(){},xn.ua=function(){},xn.Oa=function(){},Lo.prototype.g=function(e,t){return new Mo(e,t)},Qn(Mo,ti),Mo.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),li(Gn(e.hb,e,t))),Di(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Do(e,null,e.W),vo(e)},Mo.prototype.close=function(){po(this.g)},Mo.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,yo(this.g,t)}else this.v?((t={}).__data__=ii(e),yo(this.g,t)):yo(this.g,e)},Mo.prototype.M=function(){this.g.j=null,delete this.j,po(this.g),delete this.g,Mo.Z.M.call(this)},Qn(xo,qi),Qn(Uo,Bi),Qn(Fo,Po),Fo.prototype.xa=function(){ni(this.g,"a")},Fo.prototype.wa=function(e){ni(this.g,new xo(e))},Fo.prototype.va=function(e){ni(this.g,new Uo(e))},Fo.prototype.ua=function(){ni(this.g,"b")},Lo.prototype.createWebChannel=Lo.prototype.g,Mo.prototype.send=Mo.prototype.u,Mo.prototype.open=Mo.prototype.m,Mo.prototype.close=Mo.prototype.close,Li.NO_ERROR=0,Li.TIMEOUT=8,Li.HTTP_ERROR=6,Mi.COMPLETE="complete",Fi.EventType=ji,ji.OPEN="a",ji.CLOSE="b",ji.ERROR="c",ji.MESSAGE="d",ti.prototype.listen=ti.prototype.N,Ys.prototype.listenOnce=Ys.prototype.O,Ys.prototype.getLastError=Ys.prototype.La,Ys.prototype.getLastErrorCode=Ys.prototype.Da,Ys.prototype.getStatus=Ys.prototype.ba,Ys.prototype.getResponseJson=Ys.prototype.Qa,Ys.prototype.getResponseText=Ys.prototype.ga,Ys.prototype.send=Ys.prototype.ea;var Vo=Fn.createWebChannelTransport=function(){return new Lo},jo=Fn.getStatEventTarget=function(){return Ai()},qo=Fn.ErrorCode=Li,Bo=Fn.EventType=Mi,Ko=Fn.Event=Si,$o=Fn.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Ho=Fn.FetchXmlHttpFactory=Hs,zo=Fn.WebChannel=Fi,Wo=Fn.XhrIo=Ys;const Go="@firebase/firestore";class Jo{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Jo.UNAUTHENTICATED=new Jo(null),Jo.GOOGLE_CREDENTIALS=new Jo("google-credentials-uid"),Jo.FIRST_PARTY=new Jo("first-party-uid"),Jo.MOCK_USER=new Jo("mock-user");let Qo="9.6.5";const Xo=new D("@firebase/firestore");function Yo(){return Xo.logLevel}function Zo(e,...t){if(Xo.logLevel<=k.DEBUG){const n=t.map(na);Xo.debug(`Firestore (${Qo}): ${e}`,...n)}}function ea(e,...t){if(Xo.logLevel<=k.ERROR){const n=t.map(na);Xo.error(`Firestore (${Qo}): ${e}`,...n)}}function ta(e,...t){if(Xo.logLevel<=k.WARN){const n=t.map(na);Xo.warn(`Firestore (${Qo}): ${e}`,...n)}}function na(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function ra(e="Unexpected state"){const t=`FIRESTORE (${Qo}) INTERNAL ASSERTION FAILED: `+e;throw ea(t),new Error(t)}function ia(e,t){e||ra()}function sa(e,t){return e}const oa={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class aa extends l{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ca{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class ua{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class la{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Jo.UNAUTHENTICATED)))}shutdown(){}}class ha{constructor(e){this.t=e,this.currentUser=Jo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new ca;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ca,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{Zo("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Zo("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ca)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Zo("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(ia("string"==typeof t.accessToken),new ua(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ia(null===e||"string"==typeof e),new Jo(e)}}class da{constructor(e,t,n){this.type="FirstParty",this.user=Jo.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class fa{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new da(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(Jo.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class pa{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ga{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null}start(e,t){this.o=n=>{e.enqueueRetryable((()=>(e=>(null!=e.error&&Zo("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`),t(e.token)))(n)))};const n=e=>{Zo("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.g.onInit((e=>n(e))),setTimeout((()=>{if(!this.appCheck){const e=this.g.getImmediate({optional:!0});e?n(e):Zo("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(ia("string"==typeof e.token),new pa(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class ma{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.p(e),this.T=e=>t.writeSequenceNumber(e))}p(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.T&&this.T(e),e}}function ya(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}ma.I=-1;class va{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=ya(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function wa(e,t){return e<t?-1:e>t?1:0}function ba(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class Ta{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new aa(oa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new aa(oa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new aa(oa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new aa(oa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ta.fromMillis(Date.now())}static fromDate(e){return Ta.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Ta(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?wa(this.nanoseconds,e.nanoseconds):wa(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class _a{constructor(e){this.timestamp=e}static fromTimestamp(e){return new _a(e)}static min(){return new _a(new Ta(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function Ia(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ea(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Sa(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ka{constructor(e,t,n){void 0===t?t=0:t>e.length&&ra(),void 0===n?n=e.length-t:n>e.length-t&&ra(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ka.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ka?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Aa extends ka{construct(e,t,n){return new Aa(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new aa(oa.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Aa(t)}static emptyPath(){return new Aa([])}}const Ca=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Na extends ka{construct(e,t,n){return new Na(e,t,n)}static isValidIdentifier(e){return Ca.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Na.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Na(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new aa(oa.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new aa(oa.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new aa(oa.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new aa(oa.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Na(t)}static emptyPath(){return new Na([])}}class Ra{constructor(e){this.fields=e,e.sort(Na.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ba(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Da{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Da(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Da(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return wa(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Da.EMPTY_BYTE_STRING=new Da("");const Oa=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pa(e){if(ia(!!e),"string"==typeof e){let t=0;const n=Oa.exec(e);if(ia(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:La(e.seconds),nanos:La(e.nanos)}}function La(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ma(e){return"string"==typeof e?Da.fromBase64String(e):Da.fromUint8Array(e)}function xa(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ua(e){const t=e.mapValue.fields.__previous_value__;return xa(t)?Ua(t):t}function Fa(e){const t=Pa(e.mapValue.fields.__local_write_time__.timestampValue);return new Ta(t.seconds,t.nanos)}function Va(e){return null==e}function ja(e){return 0===e&&1/e==-1/0}function qa(e){return"number"==typeof e&&Number.isInteger(e)&&!ja(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}class Ba{constructor(e){this.path=e}static fromPath(e){return new Ba(Aa.fromString(e))}static fromName(e){return new Ba(Aa.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===Aa.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Aa.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ba(new Aa(e.slice()))}}function Ka(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?xa(e)?4:10:ra()}function $a(e,t){if(e===t)return!0;const n=Ka(e);if(n!==Ka(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Fa(e).isEqual(Fa(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Pa(e.timestampValue),r=Pa(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ma(e.bytesValue).isEqual(Ma(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return La(e.geoPointValue.latitude)===La(t.geoPointValue.latitude)&&La(e.geoPointValue.longitude)===La(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return La(e.integerValue)===La(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=La(e.doubleValue),r=La(t.doubleValue);return n===r?ja(n)===ja(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ba(e.arrayValue.values||[],t.arrayValue.values||[],$a);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Ia(n)!==Ia(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!$a(n[e],r[e])))return!1;return!0}(e,t);default:return ra()}}function Ha(e,t){return void 0!==(e.values||[]).find((e=>$a(e,t)))}function za(e,t){if(e===t)return 0;const n=Ka(e),r=Ka(t);if(n!==r)return wa(n,r);switch(n){case 0:return 0;case 1:return wa(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=La(e.integerValue||e.doubleValue),r=La(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Wa(e.timestampValue,t.timestampValue);case 4:return Wa(Fa(e),Fa(t));case 5:return wa(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Ma(e),r=Ma(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=wa(n[e],r[e]);if(0!==t)return t}return wa(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=wa(La(e.latitude),La(t.latitude));return 0!==n?n:wa(La(e.longitude),La(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=za(n[e],r[e]);if(t)return t}return wa(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=wa(r[e],s[e]);if(0!==t)return t;const o=za(n[r[e]],i[s[e]]);if(0!==o)return o}return wa(r.length,s.length)}(e.mapValue,t.mapValue);default:throw ra()}}function Wa(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return wa(e,t);const n=Pa(e),r=Pa(t),i=wa(n.seconds,r.seconds);return 0!==i?i:wa(n.nanos,r.nanos)}function Ga(e){return Ja(e)}function Ja(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Pa(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ma(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Ba.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Ja(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Ja(e.fields[i])}`;return n+"}"}(e.mapValue):ra();var t,n}function Qa(e){return!!e&&"integerValue"in e}function Xa(e){return!!e&&"arrayValue"in e}function Ya(e){return!!e&&"nullValue"in e}function Za(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ec(e){return!!e&&"mapValue"in e}function tc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ea(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=tc(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=tc(e.arrayValue.values[n]);return t}return Object.assign({},e)}class nc{constructor(e){this.value=e}static empty(){return new nc({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ec(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=tc(t)}setAll(e){let t=Na.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=tc(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());ec(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $a(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];ec(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ea(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new nc(tc(this.value))}}function rc(e){const t=[];return Ea(e.fields,((e,n)=>{const r=new Na([e]);if(ec(n)){const e=rc(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Ra(t)}class ic{constructor(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}static newInvalidDocument(e){return new ic(e,0,_a.min(),nc.empty(),0)}static newFoundDocument(e,t,n){return new ic(e,1,t,n,0)}static newNoDocument(e,t){return new ic(e,2,t,nc.empty(),0)}static newUnknownDocument(e,t){return new ic(e,3,t,nc.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nc.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nc.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ic&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ic(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class sc{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.R=null}}function oc(e,t=null,n=[],r=[],i=null,s=null,o=null){return new sc(e,t,n,r,i,s,o)}function ac(e){const t=sa(e);if(null===t.R){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>function(e){return e.field.canonicalString()+e.op.toString()+Ga(e.value)}(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Va(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=bc(t.startAt)),t.endAt&&(e+="|ub:",e+=bc(t.endAt)),t.R=e}return t.R}function cc(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!_c(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(n=e.filters[i],r=t.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!$a(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ec(e.startAt,t.startAt)&&Ec(e.endAt,t.endAt)}function uc(e){return Ba.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class lc extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.P(e,t,n):new hc(e,t,n):"array-contains"===t?new gc(e,n):"in"===t?new mc(e,n):"not-in"===t?new yc(e,n):"array-contains-any"===t?new vc(e,n):new lc(e,t,n)}static P(e,t,n){return"in"===t?new dc(e,n):new fc(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.v(za(t,this.value)):null!==t&&Ka(this.value)===Ka(t)&&this.v(za(t,this.value))}v(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ra()}}V(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class hc extends lc{constructor(e,t,n){super(e,t,n),this.key=Ba.fromName(n.referenceValue)}matches(e){const t=Ba.comparator(e.key,this.key);return this.v(t)}}class dc extends lc{constructor(e,t){super(e,"in",t),this.keys=pc("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class fc extends lc{constructor(e,t){super(e,"not-in",t),this.keys=pc("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function pc(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Ba.fromName(e.referenceValue)))}class gc extends lc{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xa(t)&&Ha(t.arrayValue,this.value)}}class mc extends lc{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ha(this.value.arrayValue,t)}}class yc extends lc{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ha(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Ha(this.value.arrayValue,t)}}class vc extends lc{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xa(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Ha(this.value.arrayValue,e)))}}class wc{constructor(e,t){this.position=e,this.before=t}}function bc(e){return`${e.before?"b":"a"}:${e.position.map((e=>Ga(e))).join(",")}`}class Tc{constructor(e,t="asc"){this.field=e,this.dir=t}}function _c(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Ic(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Ba.comparator(Ba.fromName(o.referenceValue),n.key):za(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function Ec(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!$a(e.position[n],t.position[n]))return!1;return!0}class Sc{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.S=null,this.D=null,this.startAt,this.endAt}}function kc(e,t,n,r,i,s,o,a){return new Sc(e,t,n,r,i,s,o,a)}function Ac(e){return new Sc(e)}function Cc(e){return!Va(e.limit)&&"F"===e.limitType}function Nc(e){return!Va(e.limit)&&"L"===e.limitType}function Rc(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Dc(e){for(const t of e.filters)if(t.V())return t.field;return null}function Oc(e){return null!==e.collectionGroup}function Pc(e){const t=sa(e);if(null===t.S){t.S=[];const e=Dc(t),n=Rc(t);if(null!==e&&null===n)e.isKeyField()||t.S.push(new Tc(e)),t.S.push(new Tc(Na.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.S.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.S.push(new Tc(Na.keyField(),e))}}}return t.S}function Lc(e){const t=sa(e);if(!t.D)if("F"===t.limitType)t.D=oc(t.path,t.collectionGroup,Pc(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of Pc(t)){const t="desc"===n.dir?"asc":"desc";e.push(new Tc(n.field,t))}const n=t.endAt?new wc(t.endAt.position,!t.endAt.before):null,r=t.startAt?new wc(t.startAt.position,!t.startAt.before):null;t.D=oc(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.D}function Mc(e,t,n){return new Sc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function xc(e,t){return cc(Lc(e),Lc(t))&&e.limitType===t.limitType}function Uc(e){return`${ac(Lc(e))}|lt:${e.limitType}`}function Fc(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>{return`${(t=e).field.canonicalString()} ${t.op} ${Ga(t.value)}`;var t})).join(", ")}]`),Va(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: "+bc(e.startAt)),e.endAt&&(t+=", endAt: "+bc(e.endAt)),`Target(${t})`}(Lc(e))}; limitType=${e.limitType})`}function Vc(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Ba.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!Ic(e.startAt,Pc(e),t))&&(!e.endAt||!Ic(e.endAt,Pc(e),t))}(e,t)}function jc(e){return(t,n)=>{let r=!1;for(const i of Pc(e)){const e=qc(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function qc(e,t,n){const r=e.field.isKeyField()?Ba.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?za(r,i):ra()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ra()}}function Bc(e,t){if(e.C){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ja(t)?"-0":t}}function Kc(e){return{integerValue:""+e}}function $c(e,t){return qa(t)?Kc(t):Bc(e,t)}class Hc{constructor(){this._=void 0}}function zc(e,t,n){return e instanceof Jc?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Qc?Xc(e,t):e instanceof Yc?Zc(e,t):function(e,t){const n=Gc(e,t),r=tu(n)+tu(e.N);return Qa(n)&&Qa(e.N)?Kc(r):Bc(e.k,r)}(e,t)}function Wc(e,t,n){return e instanceof Qc?Xc(e,t):e instanceof Yc?Zc(e,t):n}function Gc(e,t){return e instanceof eu?Qa(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class Jc extends Hc{}class Qc extends Hc{constructor(e){super(),this.elements=e}}function Xc(e,t){const n=nu(t);for(const t of e.elements)n.some((e=>$a(e,t)))||n.push(t);return{arrayValue:{values:n}}}class Yc extends Hc{constructor(e){super(),this.elements=e}}function Zc(e,t){let n=nu(t);for(const t of e.elements)n=n.filter((e=>!$a(e,t)));return{arrayValue:{values:n}}}class eu extends Hc{constructor(e,t){super(),this.k=e,this.N=t}}function tu(e){return La(e.integerValue||e.doubleValue)}function nu(e){return Xa(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class ru{constructor(e,t){this.version=e,this.transformResults=t}}class iu{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new iu}static exists(e){return new iu(void 0,e)}static updateTime(e){return new iu(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function su(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class ou{}function au(e,t,n){e instanceof du?function(e,t,n){const r=e.value.clone(),i=gu(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof fu?function(e,t,n){if(!su(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=gu(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(pu(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function cu(e,t,n){e instanceof du?function(e,t,n){if(!su(e.precondition,t))return;const r=e.value.clone(),i=mu(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(hu(t),r).setHasLocalMutations()}(e,t,n):e instanceof fu?function(e,t,n){if(!su(e.precondition,t))return;const r=mu(e.fieldTransforms,n,t),i=t.data;i.setAll(pu(e)),i.setAll(r),t.convertToFoundDocument(hu(t),i).setHasLocalMutations()}(e,t,n):function(e,t){su(e.precondition,t)&&t.convertToNoDocument(_a.min())}(e,t)}function uu(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Gc(r.transform,e||null);null!=i&&(null==n&&(n=nc.empty()),n.set(r.field,i))}return n||null}function lu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ba(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Qc&&t instanceof Qc||e instanceof Yc&&t instanceof Yc?ba(e.elements,t.elements,$a):e instanceof eu&&t instanceof eu?$a(e.N,t.N):e instanceof Jc&&t instanceof Jc}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function hu(e){return e.isFoundDocument()?e.version:_a.min()}class du extends ou{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}}class fu extends ou{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}}function pu(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function gu(e,t,n){const r=new Map;ia(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Wc(o,a,n[i]))}return r}function mu(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,zc(e,s,t))}return r}class yu extends ou{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class vu extends ou{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}class wu{constructor(e){this.count=e}}var bu,Tu;function _u(e){switch(e){default:return ra();case oa.CANCELLED:case oa.UNKNOWN:case oa.DEADLINE_EXCEEDED:case oa.RESOURCE_EXHAUSTED:case oa.INTERNAL:case oa.UNAVAILABLE:case oa.UNAUTHENTICATED:return!1;case oa.INVALID_ARGUMENT:case oa.NOT_FOUND:case oa.ALREADY_EXISTS:case oa.PERMISSION_DENIED:case oa.FAILED_PRECONDITION:case oa.ABORTED:case oa.OUT_OF_RANGE:case oa.UNIMPLEMENTED:case oa.DATA_LOSS:return!0}}function Iu(e){if(void 0===e)return ea("GRPC error has no .code"),oa.UNKNOWN;switch(e){case bu.OK:return oa.OK;case bu.CANCELLED:return oa.CANCELLED;case bu.UNKNOWN:return oa.UNKNOWN;case bu.DEADLINE_EXCEEDED:return oa.DEADLINE_EXCEEDED;case bu.RESOURCE_EXHAUSTED:return oa.RESOURCE_EXHAUSTED;case bu.INTERNAL:return oa.INTERNAL;case bu.UNAVAILABLE:return oa.UNAVAILABLE;case bu.UNAUTHENTICATED:return oa.UNAUTHENTICATED;case bu.INVALID_ARGUMENT:return oa.INVALID_ARGUMENT;case bu.NOT_FOUND:return oa.NOT_FOUND;case bu.ALREADY_EXISTS:return oa.ALREADY_EXISTS;case bu.PERMISSION_DENIED:return oa.PERMISSION_DENIED;case bu.FAILED_PRECONDITION:return oa.FAILED_PRECONDITION;case bu.ABORTED:return oa.ABORTED;case bu.OUT_OF_RANGE:return oa.OUT_OF_RANGE;case bu.UNIMPLEMENTED:return oa.UNIMPLEMENTED;case bu.DATA_LOSS:return oa.DATA_LOSS;default:return ra()}}(Tu=bu||(bu={}))[Tu.OK=0]="OK",Tu[Tu.CANCELLED=1]="CANCELLED",Tu[Tu.UNKNOWN=2]="UNKNOWN",Tu[Tu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tu[Tu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tu[Tu.NOT_FOUND=5]="NOT_FOUND",Tu[Tu.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tu[Tu.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tu[Tu.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tu[Tu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tu[Tu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tu[Tu.ABORTED=10]="ABORTED",Tu[Tu.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tu[Tu.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tu[Tu.INTERNAL=13]="INTERNAL",Tu[Tu.UNAVAILABLE=14]="UNAVAILABLE",Tu[Tu.DATA_LOSS=15]="DATA_LOSS";class Eu{constructor(e,t){this.comparator=e,this.root=t||ku.EMPTY}insert(e,t){return new Eu(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ku.BLACK,null,null))}remove(e){return new Eu(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ku.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Su(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Su(this.root,e,this.comparator,!1)}getReverseIterator(){return new Su(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Su(this.root,e,this.comparator,!0)}}class Su{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ku{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ku.RED,this.left=null!=r?r:ku.EMPTY,this.right=null!=i?i:ku.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new ku(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ku.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return ku.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ku.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ku.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ra();if(this.right.isRed())throw ra();const e=this.left.check();if(e!==this.right.check())throw ra();return e+(this.isRed()?0:1)}}ku.EMPTY=null,ku.RED=!0,ku.BLACK=!1,ku.EMPTY=new class{constructor(){this.size=0}get key(){throw ra()}get value(){throw ra()}get color(){throw ra()}get left(){throw ra()}get right(){throw ra()}copy(e,t,n,r,i){return this}insert(e,t,n){return new ku(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Au{constructor(e){this.comparator=e,this.data=new Eu(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Cu(this.data.getIterator())}getIteratorFrom(e){return new Cu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Au))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Au(this.comparator);return t.data=e,t}}class Cu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const Nu=new Eu(Ba.comparator);function Ru(){return Nu}const Du=new Eu(Ba.comparator);function Ou(){return Du}const Pu=new Eu(Ba.comparator);function Lu(){return Pu}const Mu=new Au(Ba.comparator);function xu(...e){let t=Mu;for(const n of e)t=t.add(n);return t}const Uu=new Au(wa);function Fu(){return Uu}class Vu{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,ju.createSynthesizedTargetChangeForCurrentChange(e,t)),new Vu(_a.min(),n,Fu(),Ru(),xu())}}class ju{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new ju(Da.EMPTY_BYTE_STRING,t,xu(),xu(),xu())}}class qu{constructor(e,t,n,r){this.$=e,this.removedTargetIds=t,this.key=n,this.O=r}}class Bu{constructor(e,t){this.targetId=e,this.M=t}}class Ku{constructor(e,t,n=Da.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class $u{constructor(){this.F=0,this.L=Wu(),this.B=Da.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}get current(){return this.U}get resumeToken(){return this.B}get K(){return 0!==this.F}get j(){return this.q}W(e){e.approximateByteSize()>0&&(this.q=!0,this.B=e)}G(){let e=xu(),t=xu(),n=xu();return this.L.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:ra()}})),new ju(this.B,this.U,e,t,n)}H(){this.q=!1,this.L=Wu()}J(e,t){this.q=!0,this.L=this.L.insert(e,t)}Y(e){this.q=!0,this.L=this.L.remove(e)}X(){this.F+=1}Z(){this.F-=1}tt(){this.q=!0,this.U=!0}}class Hu{constructor(e){this.et=e,this.nt=new Map,this.st=Ru(),this.it=zu(),this.rt=new Au(wa)}ot(e){for(const t of e.$)e.O&&e.O.isFoundDocument()?this.ct(t,e.O):this.at(t,e.key,e.O);for(const t of e.removedTargetIds)this.at(t,e.key,e.O)}ut(e){this.forEachTarget(e,(t=>{const n=this.ht(t);switch(e.state){case 0:this.lt(t)&&n.W(e.resumeToken);break;case 1:n.Z(),n.K||n.H(),n.W(e.resumeToken);break;case 2:n.Z(),n.K||this.removeTarget(t);break;case 3:this.lt(t)&&(n.tt(),n.W(e.resumeToken));break;case 4:this.lt(t)&&(this.ft(t),n.W(e.resumeToken));break;default:ra()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.nt.forEach(((e,n)=>{this.lt(n)&&t(n)}))}dt(e){const t=e.targetId,n=e.M.count,r=this.wt(t);if(r){const e=r.target;if(uc(e))if(0===n){const n=new Ba(e.path);this.at(t,n,ic.newNoDocument(n,_a.min()))}else ia(1===n);else this._t(t)!==n&&(this.ft(t),this.rt=this.rt.add(t))}}gt(e){const t=new Map;this.nt.forEach(((n,r)=>{const i=this.wt(r);if(i){if(n.current&&uc(i.target)){const t=new Ba(i.target.path);null!==this.st.get(t)||this.yt(r,t)||this.at(r,t,ic.newNoDocument(t,e))}n.j&&(t.set(r,n.G()),n.H())}}));let n=xu();this.it.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.wt(e);return!t||2===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))}));const r=new Vu(e,t,this.rt,this.st,n);return this.st=Ru(),this.it=zu(),this.rt=new Au(wa),r}ct(e,t){if(!this.lt(e))return;const n=this.yt(e,t.key)?2:0;this.ht(e).J(t.key,n),this.st=this.st.insert(t.key,t),this.it=this.it.insert(t.key,this.Tt(t.key).add(e))}at(e,t,n){if(!this.lt(e))return;const r=this.ht(e);this.yt(e,t)?r.J(t,1):r.Y(t),this.it=this.it.insert(t,this.Tt(t).delete(e)),n&&(this.st=this.st.insert(t,n))}removeTarget(e){this.nt.delete(e)}_t(e){const t=this.ht(e).G();return this.et.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}X(e){this.ht(e).X()}ht(e){let t=this.nt.get(e);return t||(t=new $u,this.nt.set(e,t)),t}Tt(e){let t=this.it.get(e);return t||(t=new Au(wa),this.it=this.it.insert(e,t)),t}lt(e){const t=null!==this.wt(e);return t||Zo("WatchChangeAggregator","Detected inactive target",e),t}wt(e){const t=this.nt.get(e);return t&&t.K?null:this.et.Et(e)}ft(e){this.nt.set(e,new $u),this.et.getRemoteKeysForTarget(e).forEach((t=>{this.at(e,t,null)}))}yt(e,t){return this.et.getRemoteKeysForTarget(e).has(t)}}function zu(){return new Eu(Ba.comparator)}function Wu(){return new Eu(Ba.comparator)}const Gu={asc:"ASCENDING",desc:"DESCENDING"},Ju={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Qu{constructor(e,t){this.databaseId=e,this.C=t}}function Xu(e,t){return e.C?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Yu(e,t){return e.C?t.toBase64():t.toUint8Array()}function Zu(e,t){return Xu(e,t.toTimestamp())}function el(e){return ia(!!e),_a.fromTimestamp(function(e){const t=Pa(e);return new Ta(t.seconds,t.nanos)}(e))}function tl(e,t){return function(e){return new Aa(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function nl(e){const t=Aa.fromString(e);return ia(El(t)),t}function rl(e,t){return tl(e.databaseId,t.path)}function il(e,t){const n=nl(t);if(n.get(1)!==e.databaseId.projectId)throw new aa(oa.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new aa(oa.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ba(cl(n))}function sl(e,t){return tl(e.databaseId,t)}function ol(e){const t=nl(e);return 4===t.length?Aa.emptyPath():cl(t)}function al(e){return new Aa(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function cl(e){return ia(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function ul(e,t,n){return{name:rl(e,t),fields:n.value.mapValue.fields}}function ll(e,t){let n;if(t instanceof du)n={update:ul(e,t.key,t.value)};else if(t instanceof yu)n={delete:rl(e,t.key)};else if(t instanceof fu)n={update:ul(e,t.key,t.data),updateMask:Il(t.fieldMask)};else{if(!(t instanceof vu))return ra();n={verify:rl(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Jc)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Qc)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Yc)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof eu)return{fieldPath:t.field.canonicalString(),increment:n.N};throw ra()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Zu(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ra()}(e,t.precondition)),n}function hl(e,t){return{documents:[sl(e,t.path)]}}function dl(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=sl(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=sl(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map((e=>function(e){if("=="===e.op){if(Za(e.value))return{unaryFilter:{field:wl(e.field),op:"IS_NAN"}};if(Ya(e.value))return{unaryFilter:{field:wl(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Za(e.value))return{unaryFilter:{field:wl(e.field),op:"IS_NOT_NAN"}};if(Ya(e.value))return{unaryFilter:{field:wl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wl(e.field),op:vl(e.op),value:e.value}}}(e)));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:wl(e.field),direction:yl(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(e,t){return e.C||Va(t)?t:{value:t}}(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=gl(t.startAt)),t.endAt&&(n.structuredQuery.endAt=gl(t.endAt)),n}function fl(e){let t=ol(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ia(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=pl(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new Tc(bl(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Va(t)?null:t}(n.limit));let c=null;n.startAt&&(c=ml(n.startAt));let u=null;return n.endAt&&(u=ml(n.endAt)),kc(t,i,o,s,a,"F",c,u)}function pl(e){return e?void 0!==e.unaryFilter?[_l(e)]:void 0!==e.fieldFilter?[Tl(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((e=>pl(e))).reduce(((e,t)=>e.concat(t))):ra():[]}function gl(e){return{before:e.before,values:e.position}}function ml(e){const t=!!e.before,n=e.values||[];return new wc(n,t)}function yl(e){return Gu[e]}function vl(e){return Ju[e]}function wl(e){return{fieldPath:e.canonicalString()}}function bl(e){return Na.fromServerFormat(e.fieldPath)}function Tl(e){return lc.create(bl(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ra()}}(e.fieldFilter.op),e.fieldFilter.value)}function _l(e){switch(e.unaryFilter.op){case"IS_NAN":const t=bl(e.unaryFilter.field);return lc.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=bl(e.unaryFilter.field);return lc.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=bl(e.unaryFilter.field);return lc.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=bl(e.unaryFilter.field);return lc.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ra()}}function Il(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function El(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function Sl(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Al(t)),t=kl(e.get(n),t);return Al(t)}function kl(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function Al(e){return e+""}class Cl{constructor(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}}Cl.store="owner",Cl.key="owner";class Nl{constructor(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}}Nl.store="mutationQueues",Nl.keyPath="userId";class Rl{constructor(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}}Rl.store="mutations",Rl.keyPath="batchId",Rl.userMutationsIndex="userMutationsIndex",Rl.userMutationsKeyPath=["userId","batchId"];class Dl{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,Sl(t)]}static key(e,t,n){return[e,Sl(t),n]}}Dl.store="documentMutations",Dl.PLACEHOLDER=new Dl;class Ol{constructor(e,t,n,r,i,s){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=s}}Ol.store="remoteDocuments",Ol.readTimeIndex="readTimeIndex",Ol.readTimeIndexPath="readTime",Ol.collectionReadTimeIndex="collectionReadTimeIndex",Ol.collectionReadTimeIndexPath=["parentPath","readTime"];class Pl{constructor(e){this.byteSize=e}}Pl.store="remoteDocumentGlobal",Pl.key="remoteDocumentGlobalKey";class Ll{constructor(e,t,n,r,i,s,o){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=s,this.query=o}}Ll.store="targets",Ll.keyPath="targetId",Ll.queryTargetsIndexName="queryTargetsIndex",Ll.queryTargetsKeyPath=["canonicalId","targetId"];class Ml{constructor(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n}}Ml.store="targetDocuments",Ml.keyPath=["targetId","path"],Ml.documentTargetsIndex="documentTargetsIndex",Ml.documentTargetsKeyPath=["path","targetId"];class xl{constructor(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}xl.key="targetGlobalKey",xl.store="targetGlobal";class Ul{constructor(e,t){this.collectionId=e,this.parent=t}}Ul.store="collectionParents",Ul.keyPath=["collectionId","parent"];class Fl{constructor(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}}Fl.store="clientMetadata",Fl.keyPath="clientId";class Vl{constructor(e,t,n){this.bundleId=e,this.createTime=t,this.version=n}}Vl.store="bundles",Vl.keyPath="bundleId";class jl{constructor(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n}}jl.store="namedQueries",jl.keyPath="name";Nl.store,Rl.store,Dl.store,Ol.store,Ll.store,Cl.store,xl.store,Ml.store,Fl.store,Pl.store,Ul.store,Vl.store,jl.store;const ql="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Bl{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}class Kl{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ra(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Kl(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Kl?t:Kl.resolve(t)}catch(e){return Kl.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Kl.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Kl.reject(t)}static resolve(e){return new Kl(((t,n)=>{t(e)}))}static reject(e){return new Kl(((t,n)=>{n(e)}))}static waitFor(e){return new Kl(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=Kl.resolve(!1);for(const n of e)t=t.next((e=>e?Kl.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}}function $l(e){return"IndexedDbTransactionError"===e.name}class Hl{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&au(r,e,n[t])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&cu(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&cu(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach((t=>{const n=e.get(t.key),r=n;this.applyToLocalView(r),n.isValidDocument()||r.convertToNoDocument(_a.min())}))}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),xu())}isEqual(e){return this.batchId===e.batchId&&ba(this.mutations,e.mutations,((e,t)=>lu(e,t)))&&ba(this.baseMutations,e.baseMutations,((e,t)=>lu(e,t)))}}class zl{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){ia(e.mutations.length===n.length);let r=Lu();const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new zl(e,t,n,r)}}class Wl{constructor(e,t,n,r,i=_a.min(),s=_a.min(),o=Da.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new Wl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Gl{constructor(e){this.Gt=e}}function Jl(e){const t=fl({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Mc(t,t.limit,"L"):t}class Ql{constructor(){this.zt=new Xl}addToCollectionParentIndex(e,t){return this.zt.add(t),Kl.resolve()}getCollectionParents(e,t){return Kl.resolve(this.zt.getEntries(t))}}class Xl{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Au(Aa.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Au(Aa.comparator)).toArray()}}class Yl{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Yl(e,Yl.DEFAULT_COLLECTION_PERCENTILE,Yl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Yl.DEFAULT_COLLECTION_PERCENTILE=10,Yl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yl.DEFAULT=new Yl(41943040,Yl.DEFAULT_COLLECTION_PERCENTILE,Yl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yl.DISABLED=new Yl(-1,0,0);class Zl{constructor(e){this.se=e}next(){return this.se+=2,this.se}static ie(){return new Zl(0)}static re(){return new Zl(-1)}}async function eh(e){if(e.code!==oa.FAILED_PRECONDITION||e.message!==ql)throw e;Zo("LocalStore","Unexpectedly lost primary lease")}class th{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}forEach(e){Ea(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return Sa(this.inner)}}class nh{constructor(){this.changes=new th((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}getReadTime(e){const t=this.changes.get(e);return t?t.readTime:_a.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:ic.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Kl.resolve(n.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class rh{constructor(e,t,n){this.Je=e,this.An=t,this.Jt=n}Rn(e,t){return this.An.getAllMutationBatchesAffectingDocumentKey(e,t).next((n=>this.bn(e,t,n)))}bn(e,t,n){return this.Je.getEntry(e,t).next((e=>{for(const t of n)t.applyToLocalView(e);return e}))}Pn(e,t){e.forEach(((e,n)=>{for(const e of t)e.applyToLocalView(n)}))}vn(e,t){return this.Je.getEntries(e,t).next((t=>this.Vn(e,t).next((()=>t))))}Vn(e,t){return this.An.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>this.Pn(t,e)))}getDocumentsMatchingQuery(e,t,n){return function(e){return Ba.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Sn(e,t.path):Oc(t)?this.Dn(e,t,n):this.Cn(e,t,n)}Sn(e,t){return this.Rn(e,new Ba(t)).next((e=>{let t=Ou();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}Dn(e,t,n){const r=t.collectionGroup;let i=Ou();return this.Jt.getCollectionParents(e,r).next((s=>Kl.forEach(s,(s=>{const o=function(e,t){return new Sc(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.Cn(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}Cn(e,t,n){let r,i;return this.Je.getDocumentsMatchingQuery(e,t,n).next((n=>(r=n,this.An.getAllMutationBatchesAffectingQuery(e,t)))).next((t=>(i=t,this.Nn(e,i,r).next((e=>{r=e;for(const e of i)for(const t of e.mutations){const n=t.key;let i=r.get(n);null==i&&(i=ic.newInvalidDocument(n),r=r.insert(n,i)),cu(t,i,e.localWriteTime),i.isFoundDocument()||(r=r.remove(n))}}))))).next((()=>(r.forEach(((e,n)=>{Vc(t,n)||(r=r.remove(e))})),r)))}Nn(e,t,n){let r=xu();for(const e of t)for(const t of e.mutations)t instanceof fu&&null===n.get(t.key)&&(r=r.add(t.key));let i=n;return this.Je.getEntries(e,r).next((e=>(e.forEach(((e,t)=>{t.isFoundDocument()&&(i=i.insert(e,t))})),i)))}}class ih{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.kn=n,this.xn=r}static $n(e,t){let n=xu(),r=xu();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new ih(e,t.fromCache,n,r)}}class sh{On(e){this.Mn=e}getDocumentsMatchingQuery(e,t,n,r){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(_a.min())?this.Fn(e,t):this.Mn.vn(e,r).next((i=>{const s=this.Ln(t,i);return(Cc(t)||Nc(t))&&this.Bn(t.limitType,s,r,n)?this.Fn(e,t):(Yo()<=k.DEBUG&&Zo("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Fc(t)),this.Mn.getDocumentsMatchingQuery(e,t,n).next((e=>(s.forEach((t=>{e=e.insert(t.key,t)})),e))))}))}Ln(e,t){let n=new Au(jc(e));return t.forEach(((t,r)=>{Vc(e,r)&&(n=n.add(r))})),n}Bn(e,t,n,r){if(n.size!==t.size)return!0;const i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Fn(e,t){return Yo()<=k.DEBUG&&Zo("QueryEngine","Using full collection scan to execute query:",Fc(t)),this.Mn.getDocumentsMatchingQuery(e,t,_a.min())}}class oh{constructor(e,t,n,r){this.persistence=e,this.Un=t,this.k=r,this.qn=new Eu(wa),this.Kn=new th((e=>ac(e)),cc),this.jn=_a.min(),this.An=e.getMutationQueue(n),this.Qn=e.getRemoteDocumentCache(),this.He=e.getTargetCache(),this.Wn=new rh(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=e.getBundleCache(),this.Un.On(this.Wn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.qn)))}}function ah(e,t,n,r){return new oh(e,t,n,r)}async function ch(e,t){const n=sa(e);let r=n.An,i=n.Wn;const s=await n.persistence.runTransaction("Handle user change","readonly",(e=>{let s;return n.An.getAllMutationBatches(e).next((o=>(s=o,r=n.persistence.getMutationQueue(t),i=new rh(n.Qn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e)))).next((t=>{const n=[],r=[];let o=xu();for(const e of s){n.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return i.vn(e,o).next((e=>({Gn:e,removedBatchIds:n,addedBatchIds:r})))}))}));return n.An=r,n.Wn=i,n.Un.On(n.Wn),s}function uh(e){const t=sa(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.He.getLastRemoteSnapshotVersion(e)))}function lh(e,t,n,r,i){let s=xu();return n.forEach((e=>s=s.add(e))),t.getEntries(e,s).next((e=>{let s=Ru();return n.forEach(((n,o)=>{const a=e.get(n),c=(null==i?void 0:i.get(n))||r;o.isNoDocument()&&o.version.isEqual(_a.min())?(t.removeEntry(n,c),s=s.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(o,c),s=s.insert(n,o)):Zo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),s}))}function hh(e,t){const n=sa(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.An.getNextMutationBatchAfterBatchId(e,t))))}function dh(e,t){const n=sa(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.He.getTargetData(e,t).next((i=>i?(r=i,Kl.resolve(r)):n.He.allocateTargetId(e).next((i=>(r=new Wl(t,i,0,e.currentSequenceNumber),n.He.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.qn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qn=n.qn.insert(e.targetId,e),n.Kn.set(t,e.targetId)),e}))}async function fh(e,t,n){const r=sa(e),i=r.qn.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!$l(e))throw e;Zo("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.qn=r.qn.remove(t),r.Kn.delete(i.target)}function ph(e,t,n){const r=sa(e);let i=_a.min(),s=xu();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=sa(e),i=r.Kn.get(n);return void 0!==i?Kl.resolve(r.qn.get(i)):r.He.getTargetData(t,n)}(r,e,Lc(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.He.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.Un.getDocumentsMatchingQuery(e,t,n?i:_a.min(),n?s:xu()))).next((e=>({documents:e,zn:s})))))}class gh{constructor(e){this.k=e,this.Xn=new Map,this.Zn=new Map}getBundleMetadata(e,t){return Kl.resolve(this.Xn.get(t))}saveBundleMetadata(e,t){var n;return this.Xn.set(t.id,{id:(n=t).id,version:n.version,createTime:el(n.createTime)}),Kl.resolve()}getNamedQuery(e,t){return Kl.resolve(this.Zn.get(t))}saveNamedQuery(e,t){return this.Zn.set(t.name,function(e){return{name:e.name,query:Jl(e.bundledQuery),readTime:el(e.readTime)}}(t)),Kl.resolve()}}class mh{constructor(){this.ts=new Au(yh.es),this.ns=new Au(yh.ss)}isEmpty(){return this.ts.isEmpty()}addReference(e,t){const n=new yh(e,t);this.ts=this.ts.add(n),this.ns=this.ns.add(n)}rs(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.os(new yh(e,t))}cs(e,t){e.forEach((e=>this.removeReference(e,t)))}us(e){const t=new Ba(new Aa([])),n=new yh(t,e),r=new yh(t,e+1),i=[];return this.ns.forEachInRange([n,r],(e=>{this.os(e),i.push(e.key)})),i}hs(){this.ts.forEach((e=>this.os(e)))}os(e){this.ts=this.ts.delete(e),this.ns=this.ns.delete(e)}ls(e){const t=new Ba(new Aa([])),n=new yh(t,e),r=new yh(t,e+1);let i=xu();return this.ns.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new yh(e,0),n=this.ts.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class yh{constructor(e,t){this.key=e,this.fs=t}static es(e,t){return Ba.comparator(e.key,t.key)||wa(e.fs,t.fs)}static ss(e,t){return wa(e.fs,t.fs)||Ba.comparator(e.key,t.key)}}class vh{constructor(e,t){this.Jt=e,this.referenceDelegate=t,this.An=[],this.ds=1,this.ws=new Au(yh.es)}checkEmpty(e){return Kl.resolve(0===this.An.length)}addMutationBatch(e,t,n,r){const i=this.ds;this.ds++,this.An.length>0&&this.An[this.An.length-1];const s=new Hl(i,t,n,r);this.An.push(s);for(const t of r)this.ws=this.ws.add(new yh(t.key,i)),this.Jt.addToCollectionParentIndex(e,t.key.path.popLast());return Kl.resolve(s)}lookupMutationBatch(e,t){return Kl.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.gs(n),i=r<0?0:r;return Kl.resolve(this.An.length>i?this.An[i]:null)}getHighestUnacknowledgedBatchId(){return Kl.resolve(0===this.An.length?-1:this.ds-1)}getAllMutationBatches(e){return Kl.resolve(this.An.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new yh(t,0),r=new yh(t,Number.POSITIVE_INFINITY),i=[];return this.ws.forEachInRange([n,r],(e=>{const t=this._s(e.fs);i.push(t)})),Kl.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Au(wa);return t.forEach((e=>{const t=new yh(e,0),r=new yh(e,Number.POSITIVE_INFINITY);this.ws.forEachInRange([t,r],(e=>{n=n.add(e.fs)}))})),Kl.resolve(this.ys(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Ba.isDocumentKey(i)||(i=i.child(""));const s=new yh(new Ba(i),0);let o=new Au(wa);return this.ws.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.fs)),!0)}),s),Kl.resolve(this.ys(o))}ys(e){const t=[];return e.forEach((e=>{const n=this._s(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){ia(0===this.ps(t.batchId,"removed")),this.An.shift();let n=this.ws;return Kl.forEach(t.mutations,(r=>{const i=new yh(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.ws=n}))}ee(e){}containsKey(e,t){const n=new yh(t,0),r=this.ws.firstAfterOrEqual(n);return Kl.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.An.length,Kl.resolve()}ps(e,t){return this.gs(e)}gs(e){return 0===this.An.length?0:e-this.An[0].batchId}_s(e){const t=this.gs(e);return t<0||t>=this.An.length?null:this.An[t]}}class wh{constructor(e,t){this.Jt=e,this.Ts=t,this.docs=new Eu(Ba.comparator),this.size=0}addEntry(e,t,n){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Ts(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o,readTime:n}),this.size+=o-s,this.Jt.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Kl.resolve(n?n.document.mutableCopy():ic.newInvalidDocument(t))}getEntries(e,t){let n=Ru();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ic.newInvalidDocument(e))})),Kl.resolve(n)}getDocumentsMatchingQuery(e,t,n){let r=Ru();const i=new Ba(t.path.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i,readTime:o}}=s.getNext();if(!t.path.isPrefixOf(e.path))break;o.compareTo(n)<=0||Vc(t,i)&&(r=r.insert(i.key,i.mutableCopy()))}return Kl.resolve(r)}Es(e,t){return Kl.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new bh(this)}getSize(e){return Kl.resolve(this.size)}}class bh extends nh{constructor(e){super(),this.De=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.document.isValidDocument()?t.push(this.De.addEntry(e,r.document,this.getReadTime(n))):this.De.removeEntry(n)})),Kl.waitFor(t)}getFromCache(e,t){return this.De.getEntry(e,t)}getAllFromCache(e,t){return this.De.getEntries(e,t)}}class Th{constructor(e){this.persistence=e,this.Is=new th((e=>ac(e)),cc),this.lastRemoteSnapshotVersion=_a.min(),this.highestTargetId=0,this.As=0,this.Rs=new mh,this.targetCount=0,this.bs=Zl.ie()}forEachTarget(e,t){return this.Is.forEach(((e,n)=>t(n))),Kl.resolve()}getLastRemoteSnapshotVersion(e){return Kl.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Kl.resolve(this.As)}allocateTargetId(e){return this.highestTargetId=this.bs.next(),Kl.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.As&&(this.As=t),Kl.resolve()}ae(e){this.Is.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.bs=new Zl(t),this.highestTargetId=t),e.sequenceNumber>this.As&&(this.As=e.sequenceNumber)}addTargetData(e,t){return this.ae(t),this.targetCount+=1,Kl.resolve()}updateTargetData(e,t){return this.ae(t),Kl.resolve()}removeTargetData(e,t){return this.Is.delete(t.target),this.Rs.us(t.targetId),this.targetCount-=1,Kl.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Is.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Is.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Kl.waitFor(i).next((()=>r))}getTargetCount(e){return Kl.resolve(this.targetCount)}getTargetData(e,t){const n=this.Is.get(t)||null;return Kl.resolve(n)}addMatchingKeys(e,t,n){return this.Rs.rs(t,n),Kl.resolve()}removeMatchingKeys(e,t,n){this.Rs.cs(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),Kl.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Rs.us(t),Kl.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Rs.ls(t);return Kl.resolve(n)}containsKey(e,t){return Kl.resolve(this.Rs.containsKey(t))}}class _h{constructor(e,t){this.Ps={},this.Be=new ma(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=e(this),this.He=new Th(this),this.Jt=new Ql,this.Je=function(e,t){return new wh(e,t)}(this.Jt,(e=>this.referenceDelegate.vs(e))),this.k=new Gl(t),this.Ye=new gh(this.k)}start(){return Promise.resolve()}shutdown(){return this.Ue=!1,Promise.resolve()}get started(){return this.Ue}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Jt}getMutationQueue(e){let t=this.Ps[e.toKey()];return t||(t=new vh(this.Jt,this.referenceDelegate),this.Ps[e.toKey()]=t),t}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getBundleCache(){return this.Ye}runTransaction(e,t,n){Zo("MemoryPersistence","Starting transaction:",e);const r=new Ih(this.Be.next());return this.referenceDelegate.Vs(),n(r).next((e=>this.referenceDelegate.Ss(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ds(e,t){return Kl.or(Object.values(this.Ps).map((n=>()=>n.containsKey(e,t))))}}class Ih extends Bl{constructor(e){super(),this.currentSequenceNumber=e}}class Eh{constructor(e){this.persistence=e,this.Cs=new mh,this.Ns=null}static ks(e){return new Eh(e)}get xs(){if(this.Ns)return this.Ns;throw ra()}addReference(e,t,n){return this.Cs.addReference(n,t),this.xs.delete(n.toString()),Kl.resolve()}removeReference(e,t,n){return this.Cs.removeReference(n,t),this.xs.add(n.toString()),Kl.resolve()}markPotentiallyOrphaned(e,t){return this.xs.add(t.toString()),Kl.resolve()}removeTarget(e,t){this.Cs.us(t.targetId).forEach((e=>this.xs.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.xs.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Vs(){this.Ns=new Set}Ss(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Kl.forEach(this.xs,(n=>{const r=Ba.fromPath(n);return this.$s(e,r).next((e=>{e||t.removeEntry(r)}))})).next((()=>(this.Ns=null,t.apply(e))))}updateLimboDocument(e,t){return this.$s(e,t).next((e=>{e?this.xs.delete(t.toString()):this.xs.add(t.toString())}))}vs(e){return 0}$s(e,t){return Kl.or([()=>Kl.resolve(this.Cs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ds(e,t)])}}class Sh{constructor(){this.activeTargetIds=Fu()}Fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ls(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ms(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class kh{constructor(){this.pi=new Sh,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.pi.Fs(e),this.Ti[e]||"not-current"}updateQueryState(e,t,n){this.Ti[e]=t}removeLocalQueryTarget(e){this.pi.Ls(e)}isLocalQueryTarget(e){return this.pi.activeTargetIds.has(e)}clearQueryState(e){delete this.Ti[e]}getAllActiveQueryTargets(){return this.pi.activeTargetIds}isActiveQueryTarget(e){return this.pi.activeTargetIds.has(e)}start(){return this.pi=new Sh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}class Ah{Ei(e){}shutdown(){}}class Ch{constructor(){this.Ii=()=>this.Ai(),this.Ri=()=>this.bi(),this.Pi=[],this.vi()}Ei(e){this.Pi.push(e)}shutdown(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}vi(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}Ai(){Zo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Pi)e(0)}bi(){Zo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Pi)e(1)}static Pt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Nh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Rh{constructor(e){this.Vi=e.Vi,this.Si=e.Si}Di(e){this.Ci=e}Ni(e){this.ki=e}onMessage(e){this.xi=e}close(){this.Si()}send(e){this.Vi(e)}$i(){this.Ci()}Oi(e){this.ki(e)}Mi(e){this.xi(e)}}class Dh extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.Fi=t+"://"+e.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Bi(e,t,n,r,i){const s=this.Ui(e,t);Zo("RestConnection","Sending: ",s,n);const o={};return this.qi(o,r,i),this.Ki(e,s,o,n).then((e=>(Zo("RestConnection","Received: ",e),e)),(t=>{throw ta("RestConnection",`${e} failed with error: `,t,"url: ",s,"request:",n),t}))}ji(e,t,n,r,i){return this.Bi(e,t,n,r,i)}qi(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Qo,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}Ui(e,t){const n=Nh[e];return`${this.Fi}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}Ki(e,t,n,r){return new Promise(((i,s)=>{const o=new Wo;o.listenOnce(Bo.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case qo.NO_ERROR:const t=o.getResponseJson();Zo("Connection","XHR received:",JSON.stringify(t)),i(t);break;case qo.TIMEOUT:Zo("Connection",'RPC "'+e+'" timed out'),s(new aa(oa.DEADLINE_EXCEEDED,"Request time out"));break;case qo.HTTP_ERROR:const n=o.getStatus();if(Zo("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(oa).indexOf(t)>=0?t:oa.UNKNOWN}(e.status);s(new aa(t,e.message))}else s(new aa(oa.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new aa(oa.UNAVAILABLE,"Connection failed."));break;default:ra()}}finally{Zo("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(r);o.send(t,"POST",a,n,15)}))}Qi(e,t,n){const r=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Vo(),l=jo(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new Ho({})),this.qi(h.initMessageHeaders,t,n),o()||c()||s().indexOf("Electron/")>=0||u()||s().indexOf("MSAppHost/")>=0||a()||(h.httpHeadersOverwriteParam="$httpHeaders");const d=r.join("");Zo("Connection","Creating WebChannel: "+d,h);const f=i.createWebChannel(d,h);let p=!1,g=!1;const m=new Rh({Vi:e=>{g?Zo("Connection","Not sending because WebChannel is closed:",e):(p||(Zo("Connection","Opening WebChannel transport."),f.open(),p=!0),Zo("Connection","WebChannel sending:",e),f.send(e))},Si:()=>f.close()}),y=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return y(f,zo.EventType.OPEN,(()=>{g||Zo("Connection","WebChannel transport opened.")})),y(f,zo.EventType.CLOSE,(()=>{g||(g=!0,Zo("Connection","WebChannel transport closed"),m.Oi())})),y(f,zo.EventType.ERROR,(e=>{g||(g=!0,ta("Connection","WebChannel transport errored:",e),m.Oi(new aa(oa.UNAVAILABLE,"The operation could not be completed")))})),y(f,zo.EventType.MESSAGE,(e=>{var t;if(!g){const n=e.data[0];ia(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){Zo("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=bu[e];if(void 0!==t)return Iu(t)}(e),n=i.message;void 0===t&&(t=oa.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),g=!0,m.Oi(new aa(t,n)),f.close()}else Zo("Connection","WebChannel received:",n),m.Mi(n)}})),y(l,Ko.STAT_EVENT,(e=>{e.stat===$o.PROXY?Zo("Connection","Detected buffering proxy"):e.stat===$o.NOPROXY&&Zo("Connection","Detected no buffering proxy")})),setTimeout((()=>{m.$i()}),0),m}}function Oh(){return"undefined"!=typeof document?document:null}function Ph(e){return new Qu(e,!0)}class Lh{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Me=e,this.timerId=t,this.Wi=n,this.Gi=r,this.zi=i,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}reset(){this.Hi=0}Xi(){this.Hi=this.zi}Zi(e){this.cancel();const t=Math.floor(this.Hi+this.tr()),n=Math.max(0,Date.now()-this.Yi),r=Math.max(0,t-n);r>0&&Zo("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Hi} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Ji=this.Me.enqueueAfterDelay(this.timerId,r,(()=>(this.Yi=Date.now(),e()))),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}er(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}cancel(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}tr(){return(Math.random()-.5)*this.Hi}}class Mh{constructor(e,t,n,r,i,s,o,a){this.Me=e,this.nr=n,this.sr=r,this.ir=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.rr=0,this.cr=null,this.ar=null,this.stream=null,this.ur=new Lh(e,t)}hr(){return 1===this.state||5===this.state||this.lr()}lr(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.dr()}async stop(){this.hr()&&await this.close(0)}wr(){this.state=0,this.ur.reset()}_r(){this.lr()&&null===this.cr&&(this.cr=this.Me.enqueueAfterDelay(this.nr,6e4,(()=>this.mr())))}gr(e){this.yr(),this.stream.send(e)}async mr(){if(this.lr())return this.close(0)}yr(){this.cr&&(this.cr.cancel(),this.cr=null)}pr(){this.ar&&(this.ar.cancel(),this.ar=null)}async close(e,t){this.yr(),this.pr(),this.ur.cancel(),this.rr++,4!==e?this.ur.reset():t&&t.code===oa.RESOURCE_EXHAUSTED?(ea(t.toString()),ea("Using maximum backoff delay to prevent overloading the backend."),this.ur.Xi()):t&&t.code===oa.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Tr(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ni(t)}Tr(){}auth(){this.state=1;const e=this.Er(this.rr),t=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.rr===t&&this.Ir(e,n)}),(t=>{e((()=>{const e=new aa(oa.UNKNOWN,"Fetching auth token failed: "+t.message);return this.Ar(e)}))}))}Ir(e,t){const n=this.Er(this.rr);this.stream=this.Rr(e,t),this.stream.Di((()=>{n((()=>(this.state=2,this.ar=this.Me.enqueueAfterDelay(this.sr,1e4,(()=>(this.lr()&&(this.state=3),Promise.resolve()))),this.listener.Di())))})),this.stream.Ni((e=>{n((()=>this.Ar(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}dr(){this.state=5,this.ur.Zi((async()=>{this.state=0,this.start()}))}Ar(e){return Zo("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Er(e){return t=>{this.Me.enqueueAndForget((()=>this.rr===e?t():(Zo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class xh extends Mh{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.k=i}Rr(e,t){return this.ir.Qi("Listen",e,t)}onMessage(e){this.ur.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:ra()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.C?(ia(void 0===t||"string"==typeof t),Da.fromBase64String(t||"")):(ia(void 0===t||t instanceof Uint8Array),Da.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?oa.UNKNOWN:Iu(e.code);return new aa(t,e.message||"")}(o);n=new Ku(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=il(e,r.document.name),s=el(r.document.updateTime),o=new nc({mapValue:{fields:r.document.fields}}),a=ic.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new qu(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=il(e,r.document),s=r.readTime?el(r.readTime):_a.min(),o=ic.newNoDocument(i,s),a=r.removedTargetIds||[];n=new qu([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=il(e,r.document),s=r.removedTargetIds||[];n=new qu([],s,i,null)}else{if(!("filter"in t))return ra();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,i=new wu(r),s=e.targetId;n=new Bu(s,i)}}return n}(this.k,e),n=function(e){if(!("targetChange"in e))return _a.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?_a.min():t.readTime?el(t.readTime):_a.min()}(e);return this.listener.br(t,n)}Pr(e){const t={};t.database=al(this.k),t.addTarget=function(e,t){let n;const r=t.target;return n=uc(r)?{documents:hl(e,r)}:{query:dl(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=Yu(e,t.resumeToken):t.snapshotVersion.compareTo(_a.min())>0&&(n.readTime=Xu(e,t.snapshotVersion.toTimestamp())),n}(this.k,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ra()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.k,e);n&&(t.labels=n),this.gr(t)}vr(e){const t={};t.database=al(this.k),t.removeTarget=e,this.gr(t)}}class Uh extends Mh{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.k=i,this.Vr=!1}get Sr(){return this.Vr}start(){this.Vr=!1,this.lastStreamToken=void 0,super.start()}Tr(){this.Vr&&this.Dr([])}Rr(e,t){return this.ir.Qi("Write",e,t)}onMessage(e){if(ia(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Vr){this.ur.reset();const t=function(e,t){return e&&e.length>0?(ia(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?el(e.updateTime):el(t);return n.isEqual(_a.min())&&(n=el(t)),new ru(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=el(e.commitTime);return this.listener.Cr(n,t)}return ia(!e.writeResults||0===e.writeResults.length),this.Vr=!0,this.listener.Nr()}kr(){const e={};e.database=al(this.k),this.gr(e)}Dr(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>ll(this.k,e)))};this.gr(t)}}class Fh extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.ir=n,this.k=r,this.$r=!1}Or(){if(this.$r)throw new aa(oa.FAILED_PRECONDITION,"The client has already been terminated.")}Bi(e,t,n){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,i])=>this.ir.Bi(e,t,n,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===oa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new aa(oa.UNKNOWN,e.toString())}))}ji(e,t,n){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,i])=>this.ir.ji(e,t,n,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===oa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new aa(oa.UNKNOWN,e.toString())}))}terminate(){this.$r=!0}}class Vh{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Mr=0,this.Fr=null,this.Lr=!0}Br(){0===this.Mr&&(this.Ur("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.Fr=null,this.qr("Backend didn't respond within 10 seconds."),this.Ur("Offline"),Promise.resolve()))))}Kr(e){"Online"===this.state?this.Ur("Unknown"):(this.Mr++,this.Mr>=1&&(this.jr(),this.qr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Ur("Offline")))}set(e){this.jr(),this.Mr=0,"Online"===e&&(this.Lr=!1),this.Ur(e)}Ur(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}qr(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Lr?(ea(t),this.Lr=!1):Zo("OnlineStateTracker",t)}jr(){null!==this.Fr&&(this.Fr.cancel(),this.Fr=null)}}class jh{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=i,this.Hr.Ei((e=>{n.enqueueAndForget((async()=>{Jh(this)&&(Zo("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=sa(e);t.Gr.add(4),await Bh(t),t.Jr.set("Unknown"),t.Gr.delete(4),await qh(t)}(this))}))})),this.Jr=new Vh(n,r)}}async function qh(e){if(Jh(e))for(const t of e.zr)await t(!0)}async function Bh(e){for(const t of e.zr)await t(!1)}function Kh(e,t){const n=sa(e);n.Wr.has(t.targetId)||(n.Wr.set(t.targetId,t),Gh(n)?Wh(n):fd(n).lr()&&Hh(n,t))}function $h(e,t){const n=sa(e),r=fd(n);n.Wr.delete(t),r.lr()&&zh(n,t),0===n.Wr.size&&(r.lr()?r._r():Jh(n)&&n.Jr.set("Unknown"))}function Hh(e,t){e.Yr.X(t.targetId),fd(e).Pr(t)}function zh(e,t){e.Yr.X(t),fd(e).vr(t)}function Wh(e){e.Yr=new Hu({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Wr.get(t)||null}),fd(e).start(),e.Jr.Br()}function Gh(e){return Jh(e)&&!fd(e).hr()&&e.Wr.size>0}function Jh(e){return 0===sa(e).Gr.size}function Qh(e){e.Yr=void 0}async function Xh(e){e.Wr.forEach(((t,n)=>{Hh(e,t)}))}async function Yh(e,t){Qh(e),Gh(e)?(e.Jr.Kr(t),Wh(e)):e.Jr.set("Unknown")}async function Zh(e,t,n){if(e.Jr.set("Online"),t instanceof Ku&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Wr.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Wr.delete(r),e.Yr.removeTarget(r))}(e,t)}catch(n){Zo("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ed(e,n)}else if(t instanceof qu?e.Yr.ot(t):t instanceof Bu?e.Yr.dt(t):e.Yr.ut(t),!n.isEqual(_a.min()))try{const t=await uh(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Yr.gt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Wr.get(r);i&&e.Wr.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.Wr.get(t);if(!n)return;e.Wr.set(t,n.withResumeToken(Da.EMPTY_BYTE_STRING,n.snapshotVersion)),zh(e,t);const r=new Wl(n.target,t,1,n.sequenceNumber);Hh(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Zo("RemoteStore","Failed to raise snapshot:",t),await ed(e,t)}}async function ed(e,t,n){if(!$l(t))throw t;e.Gr.add(1),await Bh(e),e.Jr.set("Offline"),n||(n=()=>uh(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Zo("RemoteStore","Retrying IndexedDB access"),await n(),e.Gr.delete(1),await qh(e)}))}function td(e,t){return t().catch((n=>ed(e,n,t)))}async function nd(e){const t=sa(e),n=pd(t);let r=t.Qr.length>0?t.Qr[t.Qr.length-1].batchId:-1;for(;rd(t);)try{const e=await hh(t.localStore,r);if(null===e){0===t.Qr.length&&n._r();break}r=e.batchId,id(t,e)}catch(e){await ed(t,e)}sd(t)&&od(t)}function rd(e){return Jh(e)&&e.Qr.length<10}function id(e,t){e.Qr.push(t);const n=pd(e);n.lr()&&n.Sr&&n.Dr(t.mutations)}function sd(e){return Jh(e)&&!pd(e).hr()&&e.Qr.length>0}function od(e){pd(e).start()}async function ad(e){pd(e).kr()}async function cd(e){const t=pd(e);for(const n of e.Qr)t.Dr(n.mutations)}async function ud(e,t,n){const r=e.Qr.shift(),i=zl.from(r,t,n);await td(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await nd(e)}async function ld(e,t){t&&pd(e).Sr&&await async function(e,t){if(_u(n=t.code)&&n!==oa.ABORTED){const n=e.Qr.shift();pd(e).wr(),await td(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await nd(e)}var n}(e,t),sd(e)&&od(e)}async function hd(e,t){const n=sa(e);n.asyncQueue.verifyOperationInProgress(),Zo("RemoteStore","RemoteStore received new credentials");const r=Jh(n);n.Gr.add(3),await Bh(n),r&&n.Jr.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Gr.delete(3),await qh(n)}async function dd(e,t){const n=sa(e);t?(n.Gr.delete(2),await qh(n)):t||(n.Gr.add(2),await Bh(n),n.Jr.set("Unknown"))}function fd(e){return e.Xr||(e.Xr=function(e,t,n){const r=sa(e);return r.Or(),new xh(t,r.ir,r.authCredentials,r.appCheckCredentials,r.k,n)}(e.datastore,e.asyncQueue,{Di:Xh.bind(null,e),Ni:Yh.bind(null,e),br:Zh.bind(null,e)}),e.zr.push((async t=>{t?(e.Xr.wr(),Gh(e)?Wh(e):e.Jr.set("Unknown")):(await e.Xr.stop(),Qh(e))}))),e.Xr}function pd(e){return e.Zr||(e.Zr=function(e,t,n){const r=sa(e);return r.Or(),new Uh(t,r.ir,r.authCredentials,r.appCheckCredentials,r.k,n)}(e.datastore,e.asyncQueue,{Di:ad.bind(null,e),Ni:ld.bind(null,e),Nr:cd.bind(null,e),Cr:ud.bind(null,e)}),e.zr.push((async t=>{t?(e.Zr.wr(),await nd(e)):(await e.Zr.stop(),e.Qr.length>0&&(Zo("RemoteStore",`Stopping write stream with ${e.Qr.length} pending writes`),e.Qr=[]))}))),e.Zr}class gd{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ca,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new gd(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new aa(oa.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function md(e,t){if(ea("AsyncQueue",`${t}: ${e}`),$l(e))return new aa(oa.UNAVAILABLE,`${t}: ${e}`);throw e}class yd{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ba.comparator(t.key,n.key):(e,t)=>Ba.comparator(e.key,t.key),this.keyedMap=Ou(),this.sortedSet=new Eu(this.comparator)}static emptySet(e){return new yd(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof yd))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new yd;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class vd{constructor(){this.eo=new Eu(Ba.comparator)}track(e){const t=e.doc.key,n=this.eo.get(t);n?0!==e.type&&3===n.type?this.eo=this.eo.insert(t,e):3===e.type&&1!==n.type?this.eo=this.eo.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.eo=this.eo.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.eo=this.eo.remove(t):1===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):ra():this.eo=this.eo.insert(t,e)}no(){const e=[];return this.eo.inorderTraversal(((t,n)=>{e.push(n)})),e}}class wd{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new wd(e,t,yd.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class bd{constructor(){this.so=void 0,this.listeners=[]}}class Td{constructor(){this.queries=new th((e=>Uc(e)),xc),this.onlineState="Unknown",this.io=new Set}}async function _d(e,t){const n=sa(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new bd),i)try{s.so=await n.onListen(r)}catch(e){const n=md(e,`Initialization of query '${Fc(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.ro(n.onlineState),s.so&&t.oo(s.so)&&Sd(n)}function Id(e,t){const n=sa(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.oo(e)&&(r=!0);i.so=e}}r&&Sd(n)}function Ed(e,t,n){const r=sa(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function Sd(e){e.io.forEach((e=>{e.next()}))}class kd{constructor(e,t,n){this.query=e,this.co=t,this.ao=!1,this.uo=null,this.onlineState="Unknown",this.options=n||{}}oo(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new wd(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.ao?this.ho(e)&&(this.co.next(e),t=!0):this.lo(e,this.onlineState)&&(this.fo(e),t=!0),this.uo=e,t}onError(e){this.co.error(e)}ro(e){this.onlineState=e;let t=!1;return this.uo&&!this.ao&&this.lo(this.uo,e)&&(this.fo(this.uo),t=!0),t}lo(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return!(this.options.wo&&n||e.docs.isEmpty()&&"Offline"!==t)}ho(e){if(e.docChanges.length>0)return!0;const t=this.uo&&this.uo.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}fo(e){e=wd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.ao=!0,this.co.next(e)}}class Ad{constructor(e){this.key=e}}class Cd{constructor(e){this.key=e}}class Nd{constructor(e,t){this.query=e,this.To=t,this.Eo=null,this.current=!1,this.Io=xu(),this.mutatedKeys=xu(),this.Ao=jc(e),this.Ro=new yd(this.Ao)}get bo(){return this.To}Po(e,t){const n=t?t.vo:new vd,r=t?t.Ro:this.Ro;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a=Cc(this.query)&&r.size===this.query.limit?r.last():null,c=Nc(this.query)&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=Vc(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.Vo(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.Ao(l,a)>0||c&&this.Ao(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),Cc(this.query)||Nc(this.query))for(;s.size>this.query.limit;){const e=Cc(this.query)?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ro:s,vo:n,Bn:o,mutatedKeys:i}}Vo(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Ro;this.Ro=e.Ro,this.mutatedKeys=e.mutatedKeys;const i=e.vo.no();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ra()}};return n(e)-n(t)}(e.type,t.type)||this.Ao(e.doc,t.doc))),this.So(n);const s=t?this.Do():[],o=0===this.Io.size&&this.current?1:0,a=o!==this.Eo;return this.Eo=o,0!==i.length||a?{snapshot:new wd(this.query,e.Ro,r,i,e.mutatedKeys,0===o,a,!1),Co:s}:{Co:s}}ro(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new vd,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}No(e){return!this.To.has(e)&&!!this.Ro.has(e)&&!this.Ro.get(e).hasLocalMutations}So(e){e&&(e.addedDocuments.forEach((e=>this.To=this.To.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.To=this.To.delete(e))),this.current=e.current)}Do(){if(!this.current)return[];const e=this.Io;this.Io=xu(),this.Ro.forEach((e=>{this.No(e.key)&&(this.Io=this.Io.add(e.key))}));const t=[];return e.forEach((e=>{this.Io.has(e)||t.push(new Cd(e))})),this.Io.forEach((n=>{e.has(n)||t.push(new Ad(n))})),t}ko(e){this.To=e.zn,this.Io=xu();const t=this.Po(e.documents);return this.applyChanges(t,!0)}xo(){return wd.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}class Rd{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Dd{constructor(e){this.key=e,this.$o=!1}}class Od{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Oo={},this.Mo=new th((e=>Uc(e)),xc),this.Fo=new Map,this.Lo=new Set,this.Bo=new Eu(Ba.comparator),this.Uo=new Map,this.qo=new mh,this.Ko={},this.jo=new Map,this.Qo=Zl.re(),this.onlineState="Unknown",this.Wo=void 0}get isPrimaryClient(){return!0===this.Wo}}async function Pd(e,t){const n=Xd(e);let r,i;const s=n.Mo.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.xo();else{const e=await dh(n.localStore,Lc(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await Ld(n,t,r,"current"===s),n.isPrimaryClient&&Kh(n.remoteStore,e)}return i}async function Ld(e,t,n,r){e.Go=(t,n,r)=>async function(e,t,n,r){let i=t.view.Po(n);i.Bn&&(i=await ph(e.localStore,t.query,!1).then((({documents:e})=>t.view.Po(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return Hd(e,t.targetId,o.Co),o.snapshot}(e,t,n,r);const i=await ph(e.localStore,t,!0),s=new Nd(t,i.zn),o=s.Po(i.documents),a=ju.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),c=s.applyChanges(o,e.isPrimaryClient,a);Hd(e,n,c.Co);const u=new Rd(t,n,s);return e.Mo.set(t,u),e.Fo.has(n)?e.Fo.get(n).push(t):e.Fo.set(n,[t]),c.snapshot}async function Md(e,t){const n=sa(e),r=n.Mo.get(t),i=n.Fo.get(r.targetId);if(i.length>1)return n.Fo.set(r.targetId,i.filter((e=>!xc(e,t)))),void n.Mo.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await fh(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),$h(n.remoteStore,r.targetId),Kd(n,r.targetId)})).catch(eh)):(Kd(n,r.targetId),await fh(n.localStore,r.targetId,!0))}async function xd(e,t){const n=sa(e);try{const e=await function(e,t){const n=sa(e),r=t.snapshotVersion;let i=n.qn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Qn.newChangeBuffer({trackRemovals:!0});i=n.qn;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.He.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.He.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(a)?u=u.withResumeToken(Da.EMPTY_BYTE_STRING,_a.min()).withLastLimboFreeSnapshotVersion(_a.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.He.updateTargetData(e,u))}));let a=Ru();if(t.documentUpdates.forEach(((r,i)=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(lh(e,s,t.documentUpdates,r,void 0).next((e=>{a=e}))),!r.isEqual(_a.min())){const t=n.He.getLastRemoteSnapshotVersion(e).next((t=>n.He.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Kl.waitFor(o).next((()=>s.apply(e))).next((()=>n.Wn.Vn(e,a))).next((()=>a))})).then((e=>(n.qn=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Uo.get(t);r&&(ia(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.$o=!0:e.modifiedDocuments.size>0?ia(r.$o):e.removedDocuments.size>0&&(ia(r.$o),r.$o=!1))})),await Gd(n,e,t)}catch(e){await eh(e)}}function Ud(e,t,n){const r=sa(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Mo.forEach(((n,r)=>{const i=r.view.ro(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=sa(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.ro(t)&&(r=!0)})),r&&Sd(n)}(r.eventManager,t),e.length&&r.Oo.br(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Fd(e,t,n){const r=sa(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Uo.get(t),s=i&&i.key;if(s){let e=new Eu(Ba.comparator);e=e.insert(s,ic.newNoDocument(s,_a.min()));const n=xu().add(s),i=new Vu(_a.min(),new Map,new Au(wa),e,n);await xd(r,i),r.Bo=r.Bo.remove(s),r.Uo.delete(t),Wd(r)}else await fh(r.localStore,t,!1).then((()=>Kd(r,t,n))).catch(eh)}async function Vd(e,t){const n=sa(e),r=t.batch.batchId;try{const e=await function(e,t){const n=sa(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.Qn.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Kl.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);ia(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))}))})),o.next((()=>e.An.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.An.performConsistencyCheck(e))).next((()=>n.Wn.vn(e,r)))}))}(n.localStore,t);Bd(n,r,null),qd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Gd(n,e)}catch(e){await eh(e)}}async function jd(e,t,n){const r=sa(e);try{const e=await function(e,t){const n=sa(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.An.lookupMutationBatch(e,t).next((t=>(ia(null!==t),r=t.keys(),n.An.removeMutationBatch(e,t)))).next((()=>n.An.performConsistencyCheck(e))).next((()=>n.Wn.vn(e,r)))}))}(r.localStore,t);Bd(r,t,n),qd(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Gd(r,e)}catch(n){await eh(n)}}function qd(e,t){(e.jo.get(t)||[]).forEach((e=>{e.resolve()})),e.jo.delete(t)}function Bd(e,t,n){const r=sa(e);let i=r.Ko[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ko[r.currentUser.toKey()]=i}}function Kd(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Fo.get(t))e.Mo.delete(r),n&&e.Oo.zo(r,n);e.Fo.delete(t),e.isPrimaryClient&&e.qo.us(t).forEach((t=>{e.qo.containsKey(t)||$d(e,t)}))}function $d(e,t){e.Lo.delete(t.path.canonicalString());const n=e.Bo.get(t);null!==n&&($h(e.remoteStore,n),e.Bo=e.Bo.remove(t),e.Uo.delete(n),Wd(e))}function Hd(e,t,n){for(const r of n)r instanceof Ad?(e.qo.addReference(r.key,t),zd(e,r)):r instanceof Cd?(Zo("SyncEngine","Document no longer in limbo: "+r.key),e.qo.removeReference(r.key,t),e.qo.containsKey(r.key)||$d(e,r.key)):ra()}function zd(e,t){const n=t.key,r=n.path.canonicalString();e.Bo.get(n)||e.Lo.has(r)||(Zo("SyncEngine","New document in limbo: "+n),e.Lo.add(r),Wd(e))}function Wd(e){for(;e.Lo.size>0&&e.Bo.size<e.maxConcurrentLimboResolutions;){const t=e.Lo.values().next().value;e.Lo.delete(t);const n=new Ba(Aa.fromString(t)),r=e.Qo.next();e.Uo.set(r,new Dd(n)),e.Bo=e.Bo.insert(n,r),Kh(e.remoteStore,new Wl(Lc(Ac(n.path)),r,2,ma.I))}}async function Gd(e,t,n){const r=sa(e),i=[],s=[],o=[];r.Mo.isEmpty()||(r.Mo.forEach(((e,a)=>{o.push(r.Go(a,t,n).then((e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);const t=ih.$n(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.Oo.br(i),await async function(e,t){const n=sa(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Kl.forEach(t,(t=>Kl.forEach(t.kn,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Kl.forEach(t.xn,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!$l(e))throw e;Zo("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.qn.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.qn=n.qn.insert(t,i)}}}(r.localStore,s))}async function Jd(e,t){const n=sa(e);if(!n.currentUser.isEqual(t)){Zo("SyncEngine","User change. New user:",t.toKey());const e=await ch(n.localStore,t);n.currentUser=t,function(e,t){e.jo.forEach((e=>{e.forEach((e=>{e.reject(new aa(oa.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.jo.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Gd(n,e.Gn)}}function Qd(e,t){const n=sa(e),r=n.Uo.get(t);if(r&&r.$o)return xu().add(r.key);{let e=xu();const r=n.Fo.get(t);if(!r)return e;for(const t of r){const r=n.Mo.get(t);e=e.unionWith(r.view.bo)}return e}}function Xd(e){const t=sa(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=xd.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Qd.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Fd.bind(null,t),t.Oo.br=Id.bind(null,t.eventManager),t.Oo.zo=Ed.bind(null,t.eventManager),t}function Yd(e){const t=sa(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Vd.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=jd.bind(null,t),t}class Zd{constructor(){this.synchronizeTabs=!1}async initialize(e){this.k=Ph(e.databaseInfo.databaseId),this.sharedClientState=this.Jo(e),this.persistence=this.Yo(e),await this.persistence.start(),this.gcScheduler=this.Xo(e),this.localStore=this.Zo(e)}Xo(e){return null}Zo(e){return ah(this.persistence,new sh,e.initialUser,this.k)}Yo(e){return new _h(Eh.ks,this.k)}Jo(e){return new kh}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ef{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Ud(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Jd.bind(null,this.syncEngine),await dd(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Td}createDatastore(e){const t=Ph(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Dh(r));var r;return function(e,t,n,r){return new Fh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>Ud(this.syncEngine,e,0),s=Ch.Pt()?new Ch:new Ah,new jh(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Od(e,t,n,r,i,s);return o&&(a.Wo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=sa(e);Zo("RemoteStore","RemoteStore shutting down."),t.Gr.add(5),await Bh(t),t.Hr.shutdown(),t.Jr.set("Unknown")}(this.remoteStore)}}class tf{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.ec(this.observer.next,e)}error(e){this.observer.error?this.ec(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}nc(){this.muted=!0}ec(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class nf{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Jo.UNAUTHENTICATED,this.clientId=va.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Zo("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Zo("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new aa(oa.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ca;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=md(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function rf(e,t){e.asyncQueue.verifyOperationInProgress(),Zo("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await ch(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}async function sf(e,t){e.asyncQueue.verifyOperationInProgress();const n=await of(e);Zo("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>hd(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>hd(t.remoteStore,n))),e.onlineComponents=t}async function of(e){return e.offlineComponents||(Zo("FirestoreClient","Using default OfflineComponentProvider"),await rf(e,new Zd)),e.offlineComponents}async function af(e){return e.onlineComponents||(Zo("FirestoreClient","Using default OnlineComponentProvider"),await sf(e,new ef)),e.onlineComponents}function cf(e){return af(e).then((e=>e.syncEngine))}async function uf(e){const t=await af(e),n=t.eventManager;return n.onListen=Pd.bind(null,t.syncEngine),n.onUnlisten=Md.bind(null,t.syncEngine),n}class lf{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class hf{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof hf&&e.projectId===this.projectId&&e.database===this.database}}const df=new Map;function ff(e,t,n){if(!n)throw new aa(oa.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function pf(e){if(!Ba.isDocumentKey(e))throw new aa(oa.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function gf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":ra()}function mf(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new aa(oa.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=gf(e);throw new aa(oa.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class yf{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new aa(oa.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new aa(oa.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new aa(oa.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vf{constructor(e,t,n){this._authCredentials=t,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yf({}),this._settingsFrozen=!1,e instanceof hf?this._databaseId=e:(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new aa(oa.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hf(e.options.projectId)}(e))}get app(){if(!this._app)throw new aa(oa.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new aa(oa.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yf(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new la;switch(e.type){case"gapi":const t=e.client;return ia(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new fa(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new aa(oa.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=df.get(e);t&&(Zo("ComponentProvider","Removing Datastore"),df.delete(e),t.terminate())}(this),Promise.resolve()}}class wf{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wf(this.firestore,e,this._key)}}class bf{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new bf(this.firestore,e,this._query)}}class Tf extends bf{constructor(e,t,n){super(e,t,Ac(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wf(this.firestore,null,new Ba(e))}withConverter(e){return new Tf(this.firestore,e,this._path)}}function _f(e,t,...n){if(e=b(e),1===arguments.length&&(t=va.A()),ff("doc","path",t),e instanceof vf){const r=Aa.fromString(t,...n);return pf(r),new wf(e,null,new Ba(r))}{if(!(e instanceof wf||e instanceof Tf))throw new aa(oa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Aa.fromString(t,...n));return pf(r),new wf(e.firestore,e instanceof Tf?e.converter:null,new Ba(r))}}class If{constructor(){this.mc=Promise.resolve(),this.gc=[],this.yc=!1,this.Tc=[],this.Ec=null,this.Ic=!1,this.Ac=!1,this.Rc=[],this.ur=new Lh(this,"async_queue_retry"),this.bc=()=>{const e=Oh();e&&Zo("AsyncQueue","Visibility state changed to "+e.visibilityState),this.ur.er()};const e=Oh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.bc)}get isShuttingDown(){return this.yc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pc(),this.vc(e)}enterRestrictedMode(e){if(!this.yc){this.yc=!0,this.Ac=e||!1;const t=Oh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.bc)}}enqueue(e){if(this.Pc(),this.yc)return new Promise((()=>{}));const t=new ca;return this.vc((()=>this.yc&&this.Ac?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.gc.push(e),this.Vc())))}async Vc(){if(0!==this.gc.length){try{await this.gc[0](),this.gc.shift(),this.ur.reset()}catch(e){if(!$l(e))throw e;Zo("AsyncQueue","Operation failed with retryable error: "+e)}this.gc.length>0&&this.ur.Zi((()=>this.Vc()))}}vc(e){const t=this.mc.then((()=>(this.Ic=!0,e().catch((e=>{this.Ec=e,this.Ic=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw ea("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Ic=!1,e))))));return this.mc=t,t}enqueueAfterDelay(e,t,n){this.Pc(),this.Rc.indexOf(e)>-1&&(t=0);const r=gd.createAndSchedule(this,e,t,n,(e=>this.Sc(e)));return this.Tc.push(r),r}Pc(){this.Ec&&ra()}verifyOperationInProgress(){}async Dc(){let e;do{e=this.mc,await e}while(e!==this.mc)}Cc(e){for(const t of this.Tc)if(t.timerId===e)return!0;return!1}Nc(e){return this.Dc().then((()=>{this.Tc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Dc()}))}kc(e){this.Rc.push(e)}Sc(e){const t=this.Tc.indexOf(e);this.Tc.splice(t,1)}}function Ef(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class Sf extends vf{constructor(e,t,n){super(e,t,n),this.type="firestore",this._queue=new If,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Af(this),this._firestoreClient.terminate()}}function kf(e){return e._firestoreClient||Af(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Af(e){var t;const n=e._freezeSettings(),r=function(e,t,n,r){return new lf(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new nf(e._authCredentials,e._appCheckCredentials,e._queue,r)}class Cf{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new aa(oa.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Na(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Nf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nf(Da.fromBase64String(e))}catch(e){throw new aa(oa.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Nf(Da.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Rf{constructor(e){this._methodName=e}}class Df{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new aa(oa.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new aa(oa.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return wa(this._lat,e._lat)||wa(this._long,e._long)}}const Of=/^__.*__$/;class Pf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new fu(e,this.data,this.fieldMask,t,this.fieldTransforms):new du(e,this.data,t,this.fieldTransforms)}}function Lf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ra()}}class Mf{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.k=n,this.ignoreUndefinedProperties=r,void 0===i&&this.xc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get $c(){return this.settings.$c}Oc(e){return new Mf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Oc({path:n,Fc:!1});return r.Lc(e),r}Bc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Oc({path:n,Fc:!1});return r.xc(),r}Uc(e){return this.Oc({path:void 0,Fc:!0})}qc(e){return zf(e,this.settings.methodName,this.settings.Kc||!1,this.path,this.settings.jc)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lc(this.path.get(e))}Lc(e){if(0===e.length)throw this.qc("Document fields must not be empty");if(Lf(this.$c)&&Of.test(e))throw this.qc('Document fields cannot begin and end with "__"')}}class xf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.k=n||Ph(e)}Qc(e,t,n,r=!1){return new Mf({$c:e,methodName:t,jc:n,path:Na.emptyPath(),Fc:!1,Kc:r},this.databaseId,this.k,this.ignoreUndefinedProperties)}}function Uf(e){const t=e._freezeSettings(),n=Ph(e._databaseId);return new xf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ff(e,t,n,r,i,s={}){const o=e.Qc(s.merge||s.mergeFields?2:0,t,n,i);Bf("Data must be an object, but it was:",o,r);const a=jf(r,o);let c,u;if(s.merge)c=new Ra(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Kf(t,r,n);if(!o.contains(i))throw new aa(oa.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Wf(e,i)||e.push(i)}c=new Ra(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new Pf(new nc(a),c,u)}function Vf(e,t){if(qf(e=b(e)))return Bf("Unsupported field value:",t,e),jf(e,t);if(e instanceof Rf)return function(e,t){if(!Lf(t.$c))throw t.qc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.qc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&4!==t.$c)throw t.qc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Vf(i,t.Uc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=b(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return $c(t.k,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ta.fromDate(e);return{timestampValue:Xu(t.k,n)}}if(e instanceof Ta){const n=new Ta(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Xu(t.k,n)}}if(e instanceof Df)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Nf)return{bytesValue:Yu(t.k,e._byteString)};if(e instanceof wf){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.qc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:tl(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.qc(`Unsupported field value: ${gf(e)}`)}(e,t)}function jf(e,t){const n={};return Sa(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ea(e,((e,r)=>{const i=Vf(r,t.Mc(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function qf(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ta||e instanceof Df||e instanceof Nf||e instanceof wf||e instanceof Rf)}function Bf(e,t,n){if(!qf(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=gf(n);throw"an object"===r?t.qc(e+" a custom object"):t.qc(e+" "+r)}}function Kf(e,t,n){if((t=b(t))instanceof Cf)return t._internalPath;if("string"==typeof t)return Hf(e,t);throw zf("Field path arguments must be of type string or ",e,!1,void 0,n)}const $f=new RegExp("[~\\*/\\[\\]]");function Hf(e,t,n){if(t.search($f)>=0)throw zf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Cf(...t.split("."))._internalPath}catch(r){throw zf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function zf(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new aa(oa.INVALID_ARGUMENT,a+e+c)}function Wf(e,t){return e.some((e=>e.isEqual(t)))}class Gf{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new wf(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Jf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Qf("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Jf extends Gf{data(){return super.data()}}function Qf(e,t){return"string"==typeof t?Hf(e,t):t instanceof Cf?t._internalPath:t._delegate._internalPath}class Xf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Yf extends Gf{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Zf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Qf("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Zf extends Yf{data(e={}){return super.data(e)}}class ep{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Xf(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Zf(this._firestore,this._userDataWriter,n.key,n,new Xf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new aa(oa.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>({type:"added",doc:new Zf(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Xf(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++})))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Zf(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Xf(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:tp(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function tp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ra()}}function np(e){if(Nc(e)&&0===e.explicitOrderBy.length)throw new aa(oa.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rp{convertValue(e,t="none"){switch(Ka(e)){case 0:return null;case 1:return e.booleanValue;case 2:return La(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ma(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ra()}}convertObject(e,t){const n={};return Ea(e.fields,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new Df(La(e.latitude),La(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ua(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Fa(e));default:return null}}convertTimestamp(e){const t=Pa(e);return new Ta(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Aa.fromString(e);ia(El(n));const r=new hf(n.get(1),n.get(3)),i=new Ba(n.popFirst(5));return r.isEqual(t)||ea(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function ip(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class sp extends rp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wf(this.firestore,null,t)}}function op(e,t){return function(e,t){const n=new ca;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Yd(e);try{const e=await function(e,t){const n=sa(e),r=Ta.now(),i=t.reduce(((e,t)=>e.add(t.key)),xu());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>n.Wn.vn(e,i).next((i=>{s=i;const o=[];for(const e of t){const t=uu(e,s.get(e.key));null!=t&&o.push(new fu(e.key,t,rc(t.value.mapValue),iu.exists(!0)))}return n.An.addMutationBatch(e,r,o,t)})))).then((e=>(e.applyToLocalDocumentSet(s),{batchId:e.batchId,changes:s})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ko[e.currentUser.toKey()];r||(r=new Eu(wa)),r=r.insert(t,n),e.Ko[e.currentUser.toKey()]=r}(r,e.batchId,n),await Gd(r,e.changes),await nd(r.remoteStore)}catch(e){const t=md(e,"Failed to persist write");n.reject(t)}}(await cf(e),t,n))),n.promise}(kf(e),t)}function ap(e,t,n){const r=n.docs.get(t._key),i=new sp(e);return new Yf(e,i,t._key,r,new Xf(n.hasPendingWrites,n.fromCache),t.converter)}!function(e,t=!0){Qo="9.6.6",q(new T("firestore",((e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=new Sf(r,new ha(e.getProvider("auth-internal")),new ga(e.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:t},n),i._setSettings(n),i}),"PUBLIC")),W(Go,"3.4.4",e),W(Go,"3.4.4","esm2017")}();const cp="firebasestorage.googleapis.com";class up extends l{constructor(e,t){super(lp(e),`Firebase Storage: ${t} (${lp(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,up.prototype)}_codeEquals(e){return lp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function lp(e){return"storage/"+e}function hp(){return new up("unknown","An unknown error occurred, please check the error payload for server response.")}function dp(){return new up("canceled","User canceled the upload/download.")}function fp(e){return new up("invalid-argument",e)}function pp(){return new up("app-deleted","The Firebase app was deleted.")}class gp{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=gp.makeFromUrl(e,t)}catch(t){return new gp(e,"")}if(""===n.path)return n;throw new up("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===cp?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let t=0;t<a.length;t++){const r=a[t],i=r.regex.exec(e);if(i){const e=i[r.indices.bucket];let t=i[r.indices.path];t||(t=""),n=new gp(e,t),r.postModify(n);break}}if(null==n)throw function(e){return new up("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class mp{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function yp(e,t,n,r){if(r<t)throw fp(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw fp(`Invalid value for '${e}'. Expected ${n} or less.`)}function vp(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}var wp;!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(wp||(wp={}));class bp{constructor(e,t,n,r,i,s,o,a,c,u,l){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=l,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new Tp(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===wp.NO_ERROR,i=n.getStatus();if(!t||this.isRetryStatusCode_(i)){const t=n.getErrorCode()===wp.ABORT;return void e(!1,new Tp(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new Tp(s,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(e){r(e)}else if(null!==i){const e=hp();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?pp():dp())}else{r(new up("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}};this.canceled_?t(0,new Tp(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return 2===a}let u=!1;function l(...e){u||(u=!0,t.apply(null,e))}function h(t){i=setTimeout((()=>{i=null,e(f,c())}),t)}function d(){s&&clearTimeout(s)}function f(e,...t){if(u)return void d();if(e)return d(),void l.call(null,e,...t);if(c()||o)return d(),void l.call(null,e,...t);let n;r<64&&(r*=2),1===a?(a=2,n=0):n=1e3*(r+Math.random()),h(n)}let p=!1;function g(e){p||(p=!0,d(),u||(null!==i?(e||(a=2),clearTimeout(i),h(0)):e||(a=1)))}return h(0),s=setTimeout((()=>{o=!0,g(!0)}),n),g}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),r=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||r}}class Tp{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function _p(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}class Ip{constructor(e,t){this._service=e,this._location=t instanceof gp?t:gp.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ip(e,t)}get root(){const e=new gp(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return _p(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new gp(this._location.bucket,e);return new Ip(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new up("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Ep(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:gp.makeFromBucketSpec(n,e)}class Sp{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=cp,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?gp.makeFromBucketSpec(r,this._host):Ep(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=gp.makeFromBucketSpec(this._url,e):this._bucket=Ep(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){yp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){yp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ip(this,e)}_makeRequest(e,t,n,r){if(this._deleted)return new mp(pp());{const i=function(e,t,n,r,i,s){const o=vp(e.urlParams),a=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new bp(a,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i)}(e,this._appId,n,r,t,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((()=>this._requests.delete(i)),(()=>this._requests.delete(i))),i}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const kp="@firebase/storage",Ap="0.9.2",Cp="storage";function Np(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new Sp(n,r,i,t,H)}q(new T(Cp,Np,"PUBLIC").setMultipleInstances(!0)),W(kp,Ap,""),W(kp,Ap,"esm2017");var Rp=n(676);const Dp="@firebase/installations",Op="0.5.5",Pp=1e4,Lp="w:0.5.5",Mp="FIS_v2",xp=36e5,Up=new h("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Fp(e){return e instanceof l&&e.code.includes("request-failed")}function Vp({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function jp(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function qp(e,t){const n=(await t.json()).error;return Up.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Bp({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Kp(e,{refreshToken:t}){const n=Bp(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}(t)),n}async function $p(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Hp(e){return new Promise((t=>{setTimeout(t,e)}))}const zp=/^[cdef][\w-]{21}$/;function Wp(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}(e);return zp.test(t)?t:""}catch(e){return""}}function Gp(e){return`${e.appName}!${e.appId}`}const Jp=new Map;function Qp(e,t){const n=Gp(e);Xp(n,t),function(e,t){const n=Zp();n&&n.postMessage({key:e,fid:t});eg()}(n,t)}function Xp(e,t){const n=Jp.get(e);if(n)for(const e of n)e(t)}let Yp=null;function Zp(){return!Yp&&"BroadcastChannel"in self&&(Yp=new BroadcastChannel("[Firebase] FID Change"),Yp.onmessage=e=>{Xp(e.data.key,e.data.fid)}),Yp}function eg(){0===Jp.size&&Yp&&(Yp.close(),Yp=null)}const tg="firebase-installations-store";let ng=null;function rg(){return ng||(ng=(0,Rp.openDb)("firebase-installations-database",1,(e=>{if(0===e.oldVersion)e.createObjectStore(tg)}))),ng}async function ig(e,t){const n=Gp(e),r=(await rg()).transaction(tg,"readwrite"),i=r.objectStore(tg),s=await i.get(n);return await i.put(t,n),await r.complete,s&&s.fid===t.fid||Qp(e,t.fid),t}async function sg(e){const t=Gp(e),n=(await rg()).transaction(tg,"readwrite");await n.objectStore(tg).delete(t),await n.complete}async function og(e,t){const n=Gp(e),r=(await rg()).transaction(tg,"readwrite"),i=r.objectStore(tg),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.complete,!o||s&&s.fid===o.fid||Qp(e,o.fid),o}async function ag(e){let t;const n=await og(e,(n=>{const r=function(e){return lg(e||{fid:Wp(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Up.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,{fid:t}){const n=Vp(e),r=Bp(e),i={fid:t,authVersion:Mp,appId:e.appId,sdkVersion:Lp},s={method:"POST",headers:r,body:JSON.stringify(i)},o=await $p((()=>fetch(n,s)));if(o.ok){const e=await o.json();return{fid:e.fid||t,registrationStatus:2,refreshToken:e.refreshToken,authToken:jp(e.authToken)}}throw await qp("Create Installation",o)}(e,t);return ig(e,n)}catch(n){throw Fp(n)&&409===n.customData.serverCode?await sg(e):await ig(e,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:cg(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function cg(e){let t=await ug(e);for(;1===t.registrationStatus;)await Hp(100),t=await ug(e);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await ag(e);return n||t}return t}function ug(e){return og(e,(e=>{if(!e)throw Up.create("installation-not-found");return lg(e)}))}function lg(e){return 1===(t=e).registrationStatus&&t.registrationTime+Pp<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function hg({appConfig:e,platformLoggerProvider:t},n){const r=function(e,{fid:t}){return`${Vp(e)}/${t}/authTokens:generate`}(e,n),i=Kp(e,n),s=t.getImmediate({optional:!0});s&&i.append("x-firebase-client",s.getPlatformInfoString());const o={installation:{sdkVersion:Lp}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await $p((()=>fetch(r,a)));if(c.ok){return jp(await c.json())}throw await qp("Generate Auth Token",c)}async function dg(e,t=!1){let n;const r=await og(e.appConfig,(r=>{if(!pg(r))throw Up.create("not-registered");const i=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+xp}(e)}(i))return r;if(1===i.requestStatus)return n=async function(e,t){let n=await fg(e.appConfig);for(;1===n.authToken.requestStatus;)await Hp(100),n=await fg(e.appConfig);const r=n.authToken;return 0===r.requestStatus?dg(e,t):r}(e,t),r;{if(!navigator.onLine)throw Up.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await hg(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await ig(e.appConfig,r),n}catch(n){if(!Fp(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await ig(e.appConfig,n)}else await sg(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function fg(e){return og(e,(e=>{if(!pg(e))throw Up.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Pp<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function pg(e){return void 0!==e&&2===e.registrationStatus}async function gg(e,t=!1){const n=e;await async function(e){const{registrationPromise:t}=await ag(e);t&&await t}(n.appConfig);return(await dg(n,t)).token}function mg(e){return Up.create("missing-app-config-values",{valueName:e})}const yg="installations",vg=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw mg("App Configuration");if(!e.name)throw mg("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw mg(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,platformLoggerProvider:B(t,"platform-logger"),_delete:()=>Promise.resolve()}},wg=e=>{const t=B(e.getProvider("app").getImmediate(),yg).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await ag(t.appConfig);return r?r.catch(console.error):dg(t).catch(console.error),n.fid}(t),getToken:e=>gg(t,e)}};q(new T(yg,vg,"PUBLIC")),q(new T("installations-internal",wg,"PRIVATE")),W(Dp,Op),W(Dp,Op,"esm2017");const bg="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Tg="google.c.a.c_id";var _g,Ig;function Eg(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Sg(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(_g||(_g={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(Ig||(Ig={}));const kg="fcm_token_details_db",Ag="fcm_token_object_Store";const Cg="firebase-messaging-store";let Ng=null;function Rg(){return Ng||(Ng=(0,Rp.openDb)("firebase-messaging-database",1,(e=>{if(0===e.oldVersion)e.createObjectStore(Cg)}))),Ng}async function Dg(e){const t=Pg(e),n=await Rg(),r=await n.transaction(Cg).objectStore(Cg).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map((e=>e.name));if(!e.includes(kg))return null}let t=null;const n=await(0,Rp.openDb)(kg,5,(async n=>{var r;if(n.oldVersion<2)return;if(!n.objectStoreNames.contains(Ag))return;const i=n.transaction.objectStore(Ag),s=await i.index("fcmSenderId").get(e);if(await i.clear(),s)if(2===n.oldVersion){const e=s;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(r=e.createTime)&&void 0!==r?r:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:Eg(e.vapidKey)}}}else if(3===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:Eg(e.auth),p256dh:Eg(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:Eg(e.vapidKey)}}}else if(4===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:Eg(e.auth),p256dh:Eg(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:Eg(e.vapidKey)}}}}));return n.close(),await(0,Rp.deleteDb)(kg),await(0,Rp.deleteDb)("fcm_vapid_details_db"),await(0,Rp.deleteDb)("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await Og(e,t),t}}async function Og(e,t){const n=Pg(e),r=(await Rg()).transaction(Cg,"readwrite");return await r.objectStore(Cg).put(t,n),await r.complete,t}function Pg({appConfig:e}){return e.appId}const Lg=new h("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});async function Mg(e,t){const n={method:"DELETE",headers:await Ug(e)};try{const r=await fetch(`${xg(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){const e=i.error.message;throw Lg.create("token-unsubscribe-failed",{errorInfo:e})}}catch(e){throw Lg.create("token-unsubscribe-failed",{errorInfo:e})}}function xg({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}async function Ug({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function Fg({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==bg&&(i.web.applicationPubKey=r),i}async function Vg(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Sg(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:Eg(t.getKey("auth")),p256dh:Eg(t.getKey("p256dh"))},r=await Dg(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await Ug(e),r=Fg(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch(`${xg(e.appConfig)}/${t.token}`,i);s=await n.json()}catch(e){throw Lg.create("token-update-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw Lg.create("token-update-failed",{errorInfo:e})}if(!s.token)throw Lg.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await Og(e.firebaseDependencies,r),n}catch(t){throw await jg(e),t}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Mg(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return qg(e.firebaseDependencies,n)}return qg(e.firebaseDependencies,n)}async function jg(e){const t=await Dg(e.firebaseDependencies);t&&(await Mg(e.firebaseDependencies,t.token),await async function(e){const t=Pg(e),n=(await Rg()).transaction(Cg,"readwrite");await n.objectStore(Cg).delete(t),await n.complete}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function qg(e,t){const n=await async function(e,t){const n=await Ug(e),r=Fg(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(xg(e.appConfig),i);s=await t.json()}catch(e){throw Lg.create("token-subscribe-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw Lg.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw Lg.create("token-subscribe-no-token");return s.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await Og(e,r),r.token}function Bg(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){if(!t.fcmOptions)return;e.fcmOptions={};const n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);const r=t.fcmOptions.analytics_label;r&&(e.fcmOptions.analyticsLabel=r)}(t,e),t}function Kg(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function $g(e){return Lg.create("missing-app-config-values",{valueName:e})}Kg("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Kg("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Hg{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw $g("App Configuration Object");if(!e.name)throw $g("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw $g(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}async function zg(e){try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch((()=>{}))}catch(e){throw Lg.create("failed-service-worker-registration",{browserErrorMessage:e.message})}}async function Wg(e,t){if(!navigator)throw Lg.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw Lg.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=bg)}(e,null==t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await zg(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw Lg.create("invalid-sw-registration");e.swRegistration=t}}(e,null==t?void 0:t.serviceWorkerRegistration),Vg(e)}async function Gg(e,t,n){const r=function(e){switch(e){case Ig.NOTIFICATION_CLICKED:return"notification_open";case Ig.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n["google.c.a.c_id"],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function Jg(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===Ig.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(Bg(n)):e.onMessageHandler.next(Bg(n)));const r=n.data;var i;"object"==typeof(i=r)&&i&&Tg in i&&"1"===r["google.c.a.e"]&&await Gg(e,n.messageType,r)}const Qg="@firebase/messaging",Xg="0.9.8",Yg=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>Wg(t,e)}};q(new T("messaging",(e=>{const t=new Hg(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(e=>Jg(t,e))),t}),"PUBLIC")),q(new T("messaging-internal",Yg,"PRIVATE")),W(Qg,Xg),W(Qg,Xg,"esm2017");const Zg="@firebase/performance",em="0.5.5",tm=em,nm="FB-PERF-TRACE-MEASURE",rm="_wt_",im="_fcp",sm="_fid",om="@firebase/performance/config",am="@firebase/performance/configexpire",cm="Performance",um=new h("performance",cm,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."}),lm=new D(cm);let hm,dm,fm,pm;lm.logLevel=k.INFO;class gm{constructor(e){if(this.window=e,!e)throw um.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&"undefined"!=typeof navigator&&navigator.cookieEnabled?"object"==typeof indexedDB||(lm.info("IndexedDB is not supported by current browswer"),!1):(lm.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;const n=new this.PerformanceObserver((e=>{for(const n of e.getEntries())t(n)}));n.observe({entryTypes:[e]})}static getInstance(){return void 0===hm&&(hm=new gm(dm)),hm}}function mm(){return fm}function ym(e,t){const n=e.length-t.length;if(n<0||n>1)throw um.create("invalid String merger input");const r=[];for(let n=0;n<e.length;n++)r.push(e.charAt(n)),t.length>n&&r.push(t.charAt(n));return r.join("")}class vm{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=ym("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=ym("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===pm&&(pm=new vm),pm}}var wm;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN"}(wm||(wm={}));const bm=["firebase_","google_","ga_"],Tm=new RegExp("^[a-zA-Z]\\w*$");function _m(){const e=gm.getInstance().navigator;return"serviceWorker"in e?e.serviceWorker.controller?2:3:1}function Im(){switch(gm.getInstance().document.visibilityState){case"visible":return wm.VISIBLE;case"hidden":return wm.HIDDEN;default:return wm.UNKNOWN}}function Em(){const e=gm.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function Sm(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.appId;if(!n)throw um.create("no app id");return n}const km="0.0.1",Am=!0,Cm="FIREBASE_INSTALLATIONS_AUTH";function Nm(e,t){const n=function(){const e=gm.getInstance().localStorage;if(!e)return;const t=e.getItem(am);if(!(t&&(n=t,Number(n)>Date.now())))return;var n;const r=e.getItem(om);if(!r)return;try{return JSON.parse(r)}catch(e){return}}();return n?(Dm(n),Promise.resolve()):function(e,t){return function(e){const t=e.getToken();return t.then((e=>{})),t}(e.installations).then((n=>{const r=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!n)throw um.create("no project id");return n}(e.app),i=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!n)throw um.create("no api key");return n}(e.app),s=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${i}`,{method:"POST",headers:{Authorization:`${Cm} ${n}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:n,app_id:Sm(e.app),app_version:tm,sdk_version:km})});return fetch(s).then((e=>{if(e.ok)return e.json();throw um.create("RC response not ok")}))})).catch((()=>{lm.info(Rm)}))}(e,t).then(Dm).then((e=>function(e){const t=gm.getInstance().localStorage;if(!e||!t)return;t.setItem(om,JSON.stringify(e)),t.setItem(am,String(Date.now()+60*vm.getInstance().configTimeToLive*60*1e3))}(e)),(()=>{}))}const Rm="Could not fetch config, will use default configs";function Dm(e){if(!e)return e;const t=vm.getInstance(),n=e.entries||{};return void 0!==n.fpr_enabled?t.loggingEnabled="true"===String(n.fpr_enabled):t.loggingEnabled=Am,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(t.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=Om(t.tracesSamplingRate),t.logNetworkAfterSampling=Om(t.networkRequestsSamplingRate),e}function Om(e){return Math.random()<=e}let Pm,Lm=1;function Mm(e){return Lm=2,Pm=Pm||function(e){return function(){const e=gm.getInstance().document;return new Promise((t=>{if(e&&"complete"!==e.readyState){const n=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()}))}().then((()=>function(e){const t=e.getId();return t.then((e=>{fm=e})),t}(e.installations))).then((t=>Nm(e,t))).then((()=>xm()),(()=>xm()))}(e),Pm}function xm(){Lm=3}const Um=1e4;let Fm,Vm=3,jm=[],qm=!1;function Bm(e){setTimeout((()=>{if(0!==Vm)return jm.length?void function(){const e=jm.splice(0,1e3),t=e.map((e=>({source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)})));(function(e,t){return function(e){const t=vm.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(e)})}(e).then((e=>(e.ok||lm.info("Call to Firebase backend failed."),e.json()))).then((e=>{const n=Number(e.nextRequestWaitMillis);let r=Um;isNaN(n)||(r=Math.max(n,r));const i=e.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(jm=[...t,...jm],lm.info("Retry transport request later.")),Vm=3,Bm(r)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:vm.getInstance().logSource,log_event:t},e).catch((()=>{jm=[...e,...jm],Vm--,lm.info(`Tries left: ${Vm}.`),Bm(Um)}))}():Bm(Um)}),e)}function Km(e){return(...t)=>{!function(e){if(!e.eventTime||!e.message)throw um.create("invalid cc log");jm=[...jm,e]}({message:e(...t),eventTime:Date.now()})}}function $m(e,t){Fm||(Fm=Km(Wm)),Fm(e,t)}function Hm(e){const t=vm.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&gm.getInstance().requiredApisAvailable()&&(e.isAuto&&Im()!==wm.VISIBLE||(3===Lm?zm(e):Mm(e.performanceController).then((()=>zm(e)),(()=>zm(e)))))}function zm(e){if(!mm())return;const t=vm.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&setTimeout((()=>$m(e,1)),0)}function Wm(e,t){return 0===t?function(e){const t={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},n={application_info:Gm(e.performanceController.app),network_request_metric:t};return JSON.stringify(n)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);const n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=n);const r={application_info:Gm(e.performanceController.app),trace_metric:t};return JSON.stringify(r)}(e)}function Gm(e){return{google_app_id:Sm(e),app_instance_id:mm(),web_app_info:{sdk_version:tm,page_url:gm.getInstance().getUrl(),service_worker_status:_m(),visibility_state:Im(),effective_connection_type:Em()},application_process_state:0}}const Jm=["_fp",im,sm];class Qm{constructor(e,t,n=!1,r){this.performanceController=e,this.name=t,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=gm.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`FB-PERF-TRACE-MEASURE-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw um.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw um.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Hm(this)}record(e,t,n){if(e<=0)throw um.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw um.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const e of Object.keys(n.metrics))isNaN(Number(n.metrics[e]))||(this.counters[e]=Number(Math.floor(n.metrics[e])));Hm(this)}incrementMetric(e,t=1){void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(n=e,r=this.name,0===n.length||n.length>100||!(r&&r.startsWith(rm)&&Jm.indexOf(n)>-1)&&n.startsWith("_"))throw um.create("invalid custom metric name",{customMetricName:e});var n,r;this.counters[e]=function(e){const t=Math.floor(e);return t<e&&lm.info(`Metric value should be an Integer, setting the value as : ${t}.`),t}(t)}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const n=!(0===(r=e).length||r.length>40||bm.some((e=>r.startsWith(e)))||!r.match(Tm));var r;const i=function(e){return 0!==e.length&&e.length<=100}(t);if(n&&i)this.customAttributes[e]=t;else{if(!n)throw um.create("invalid attribute name",{attributeName:e});if(!i)throw um.create("invalid attribute value",{attributeValue:t})}}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,n,r){const i=gm.getInstance().getUrl();if(!i)return;const s=new Qm(e,rm+i,!0),o=Math.floor(1e3*gm.getInstance().getTimeOrigin());s.setStartTime(o),t&&t[0]&&(s.setDuration(Math.floor(1e3*t[0].duration)),s.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),s.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),s.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(n){const e=n.find((e=>"first-paint"===e.name));e&&e.startTime&&s.putMetric("_fp",Math.floor(1e3*e.startTime));const t=n.find((e=>"first-contentful-paint"===e.name));t&&t.startTime&&s.putMetric(im,Math.floor(1e3*t.startTime)),r&&s.putMetric(sm,Math.floor(1e3*r))}Hm(s)}static createUserTimingTrace(e,t){Hm(new Qm(e,t,!1,t))}}function Xm(e,t){const n=t;if(!n||void 0===n.responseStart)return;const r=gm.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),s=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime));!function(e){const t=vm.getInstance();if(!t.instrumentationEnabled)return;const n=e.url,r=t.logEndPointUrl.split("?")[0],i=t.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout((()=>$m(e,0)),0)}({performanceController:e,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:s,timeToResponseCompletedUs:o})}function Ym(e){mm()&&(setTimeout((()=>function(e){const t=gm.getInstance(),n=t.getEntriesByType("navigation"),r=t.getEntriesByType("paint");if(t.onFirstInputDelay){let i=setTimeout((()=>{Qm.createOobTrace(e,n,r),i=void 0}),5e3);t.onFirstInputDelay((t=>{i&&(clearTimeout(i),Qm.createOobTrace(e,n,r,t))}))}else Qm.createOobTrace(e,n,r)}(e)),0),setTimeout((()=>function(e){const t=gm.getInstance(),n=t.getEntriesByType("resource");for(const t of n)Xm(e,t);t.setupObserver("resource",(t=>Xm(e,t)))}(e)),0),setTimeout((()=>function(e){const t=gm.getInstance(),n=t.getEntriesByType("measure");for(const t of n)Zm(e,t);t.setupObserver("measure",(t=>Zm(e,t)))}(e)),0))}function Zm(e,t){const n=t.name;n.substring(0,nm.length)!==nm&&Qm.createUserTimingTrace(e,n)}class ey{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),gm.getInstance().requiredApisAvailable()?new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((e=>{e&&(qm||(Bm(5500),qm=!0),Mm(this).then((()=>Ym(this)),(()=>Ym(this))),this.initialized=!0)})).catch((e=>{lm.info(`Environment doesn't support IndexedDB: ${e}`)})):lm.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){vm.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return vm.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){vm.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return vm.getInstance().dataCollectionEnabled}}const ty=(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if("[DEFAULT]"!==n.name)throw um.create("FB not default");if("undefined"==typeof window)throw um.create("no window");!function(e){dm=e}(window);const i=new ey(n,r);return i._init(t),i};function ny(e,t,n){return{day:e,month:t,year:n,getDate:()=>`${e.toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})}.${t.toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})}.${n.toLocaleString("en-US",{minimumIntegerDigits:4,useGrouping:!1})}`}}q(new T("performance",ty,"PUBLIC")),W(Zg,em),W(Zg,em,"esm2017");const ry=function(){document.querySelector(".project-selected").addEventListener("click",(t=>{sy.selectProject(null),e()}));const e=()=>{const e=document.querySelector("#todos");document.querySelectorAll("#todos > *:not(template)").forEach((t=>{e.removeChild(t)}));let t=null;const n=document.querySelector("#todo-card-template"),r=document.querySelector("#todo-date-template");for(let i of sy.getTodos()){if(JSON.stringify(t)!==JSON.stringify(i.date)){t=i.date;const n=r.content.firstElementChild.cloneNode(!0);n.textContent=t.getDate(),e.appendChild(n)}const s=n.content.firstElementChild.cloneNode(!0);s.addEventListener("click",(e=>{const t=s.querySelector(".expandable-area");t.classList.contains("expandable-area--hidden")?t.style.maxHeight=t.scrollHeight+"px":t.style.maxHeight=null,t.classList.toggle("expandable-area--hidden")})),s.querySelector(".todo-done-checkox").addEventListener("click",(e=>{e.stopPropagation()})),s.querySelector(".todo-done-checkox").addEventListener("change",(e=>{s.classList.toggle("todo-card--done"),i.done=e.target.checked,iy.saveProjects()})),s.querySelector(".todo-name").textContent=i.name,s.querySelector(".todo-description").textContent=i.description,e.appendChild(s)}};return{showNewProjectDialog:()=>{document.querySelector("#new-project-dialog").classList.toggle("dialog--hidden")},showNewTodoDialog:()=>{const e=document.querySelector("#new-todo-project");e.querySelectorAll("option[data-project]").forEach((t=>{e.removeChild(t)})),e.querySelector("option").selected=!0;const t=document.querySelector("#new-todo-project-selector-template");for(let n of sy.getProjectNames()){const r=t.content.firstElementChild.cloneNode(!0);r.textContent=n,r.setAttribute("data-project",n),e.appendChild(r)}document.querySelector("#new-todo-dialog").classList.toggle("dialog--hidden")},closeDialogs:()=>{document.querySelectorAll(".dialog-container input, .dialog-container textarea").forEach((e=>e.value="")),document.querySelectorAll(".dialog-container").forEach((e=>e.classList.add("dialog--hidden")))},updateProjects:()=>{const e=document.querySelector("#sidebar");e.querySelectorAll(".project[data-project]").forEach((t=>{e.removeChild(t)}));const t=document.querySelector("#project-template"),n=sy.getCurrentProject();for(let r of sy.getProjectNames()){const i=t.content.firstElementChild.cloneNode(!0);i.querySelector(".project-name").textContent=r,r===n&&(i.querySelector(".project-selected").checked=!0),i.querySelector(".project-selected").addEventListener("click",(e=>{e.target.checked&&(sy.selectProject(r),ry.updateTodos())})),e.insertBefore(i,e.querySelector(".divider"))}},updateTodos:e}}(),iy={saveProjects:async()=>{if(Mn().currentUser){const e=JSON.stringify(sy.getRawProjects());!function(e,t,n){e=mf(e,wf);const r=mf(e.firestore,Sf),i=ip(e.converter,t,n);op(r,[Ff(Uf(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,iu.none())])}(_f(ay,"users",oy()),{todos:e},{merge:!0}),console.log("SAVE TODOS")}},loadProjects:()=>({})},sy=function(e){let t=e,n=null;return{addProject:e=>!t.hasOwnProperty(e)&&(t[e]=function(e){return{name:e,todos:[]}}(e),!0),getProjectNames:()=>Object.keys(t),selectProject:e=>{n=e},getCurrentProject:()=>n,addTodo:(e,n,r,i,s,o)=>{t[e].todos.push(function(e,t,n){return{name:e,description:t,date:n,done:!1}}(n,r,ny(i,s,o)))},getTodos:()=>{let e=(n?t[n].todos:Object.values(t).map((e=>e.todos)).flat(1)).slice();return e.sort(((e,t)=>1e4*e.date.year+100*e.date.month+e.date.day-(1e4*t.date.year+100*t.date.month+t.date.day))),e},getRawProjects:()=>t,setRawProjects:e=>{t=e}}}(iy.loadProjects());document.querySelectorAll(".close-dialog").forEach((e=>{e.addEventListener("click",ry.closeDialogs)})),document.querySelector("#add-todo").addEventListener("click",(e=>{ry.showNewTodoDialog()})),document.querySelector("#add-project").addEventListener("click",(e=>{ry.showNewProjectDialog()})),document.querySelector("#confirm-new-project").addEventListener("click",(e=>{const t=document.querySelector("#new-project-title").value;t&&sy.addProject(t)&&(ry.closeDialogs(),ry.updateProjects(),iy.saveProjects())})),document.querySelector("#confirm-new-todo").addEventListener("click",(e=>{const t=document.querySelector("#new-todo-name").value,n=document.querySelector("#new-todo-date").value,r=document.querySelector("#new-todo-description").value,i=document.querySelector("#new-todo-project").selectedOptions[0].getAttribute("data-project");if(t&&n&&r&&i){const e=new Date,[s,o,a]=n.split("-").map((e=>parseInt(e)));s<e.getFullYear()||s==e.getFullYear()&&o<e.getMonth()+1||s==e.getFullYear()&&o==e.getMonth()+1&&a<e.getDate()||(sy.addTodo(i,t,r,a,o,s),ry.closeDialogs(),ry.updateTodos(),iy.saveProjects())}})),document.querySelector("#user-space-login button").addEventListener("click",(e=>{!async function(){await async function(e,t,n){const r=Ye(e);ie(e,t,ut);const i=Gt(r,n);return new tn(r,"signInViaPopup",t,i).executeNotNull()}(Mn(),new dt)}()})),document.querySelector("#user-space-logout button").addEventListener("click",(e=>{b(Mn()).signOut()})),ry.updateProjects(),ry.updateTodos();function oy(){return Mn().currentUser.uid}const ay=function(e=z()){return B(e,"firestore").getImmediate()}(function(e,t={}){if("object"!=typeof t){t={name:t}}const n=Object.assign({name:x,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw K.create("bad-app-name",{appName:String(r)});const i=F.get(r);if(i){if(f(e,i.options)&&f(n,i.config))return i;throw K.create("duplicate-app",{appName:r})}const s=new E(r);for(const e of V.values())s.addComponent(e);const o=new $(e,n,s);return F.set(r,o),o}({apiKey:"AIzaSyB89yGx-5vnLzPTdb9Uh_Un1U_qbuiy3xg",authDomain:"abilnf-odin-todo-list.firebaseapp.com",projectId:"abilnf-odin-todo-list",storageBucket:"abilnf-odin-todo-list.appspot.com",messagingSenderId:"306488700134",appId:"1:306488700134:web:d34439e3eb161e7662df27"}));var cy,uy,ly,hy;cy=Mn(),uy=function(e){e?(document.querySelector("#user-space-login").classList.add("user-space--hidden"),document.querySelector("#user-space-logout").classList.remove("user-space--hidden"),document.querySelector("#user-space-logout img").setAttribute("src",e.photoURL),function(e,...t){var n,r,i;e=b(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Ef(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Ef(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,u,l;if(e instanceof wf)u=mf(e.firestore,Sf),l=Ac(e._key.path),c={next:n=>{t[o]&&t[o](ap(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=mf(e,bf);u=mf(n.firestore,Sf),l=n._query;const r=new sp(u);c={next:e=>{t[o]&&t[o](new ep(u,r,n,e))},error:t[o+1],complete:t[o+2]},np(e._query)}!function(e,t,n,r){const i=new tf(r),s=new kd(t,i,n);e.asyncQueue.enqueueAndForget((async()=>_d(await uf(e),s)))}(kf(u),l,a,c)}(function(e,...t){for(const n of t)e=n._apply(e);return e}(_f(ay,"users",oy())),(function(e){const t=e.data().todos;if(t===JSON.stringify(sy.getRawProjects()))return void console.log("DONT LOAD");console.log("LOAD TODOS");const n=JSON.parse(t);for(let e of Object.values(n)){const t=[];for(let n of e.todos)n.date=ny(n.date.day,n.date.month,n.date.year),n.done||t.push(n);e.todos=t}sy.setRawProjects(n),ry.updateProjects(),ry.updateTodos()}))):(document.querySelector("#user-space-login").classList.remove("user-space--hidden"),document.querySelector("#user-space-logout").classList.add("user-space--hidden"))},b(cy).onAuthStateChanged(uy,ly,hy)})()})();